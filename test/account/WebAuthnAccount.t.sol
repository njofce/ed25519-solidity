// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import "openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import "../../src/account/WebAuthnAccount.sol";
import "../../src/static/Structs.sol";

contract WebAuthnAccountTest is Test {
    WebAuthnAccount public accountImpl;

    function setUp() public {
        IEntryPoint entryPoint = IEntryPoint(address(0));
        accountImpl = new WebAuthnAccount(entryPoint);
    }

    function testValidateSignatureForAccount_ValidSignature() public {
        bytes memory signature = abi.encode(
            P256Signature({
                R: 0x7e7833004a30efb68db1da3eb32e7a1b6feb163e28e023c02976fb298ec3fdd1,
                S: 0xf052d8c11f747eb4b5d25eddd3bcafe6b7f10aafff8541f849b53a9a0faf9425
            })
        );

        DevicePublicKey memory pubKey = DevicePublicKey({
            x: 0x40649802cbb8b049aa001f8491185e2d32c865f995d18e0f913a874899727352,
            y: 0xdef435be86f52522de84cd642fc59a00fe5e02c86763c4fdf204991f9331646f
        });

        // Deploy Precomputations for public key - retrieved from the server for the given public key coordinates

        bytes
            memory precomputationsInitCode = hex"608060405234801561001057600080fd5b5060405161477a38038061477a83398101604081905261002f91610037565b600055610050565b60006020828403121561004957600080fd5b5051919050565b61471b8061005f6000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c8063b5cedec81461003b578063f050fc4e14610063575b600080fd5b61004e61004936600461067c565b61007a565b60405190151581526020015b60405180910390f35b61006c60005481565b60405190815260200161005a565b60006100898383600054610090565b9392505050565b6000823515806100af57506000805160206106c6833981519152833510155b806100bc57506020830135155b806100d957506000805160206106c6833981519152602084013510155b156100e657506000610089565b60006100f56020850135610157565b905060006101276000805160206106c68339815191528388096000805160206106c683398151915284883509866101d0565b90506000805160206106c683398151915285356000805160206106c6833981519152038208159695505050505050565b600061016161065e565b60208152602080820152602060408201528260608201527fffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254f60808201526000805160206106c683398151915260a082015260208160c08360006005600019f16101c957600080fd5b5192915050565b6000806101db61065e565b61010091505b80516000036102765760018203915060c0820386901c6001166080830387901c6001166002026040840388901c6001166004028489901c60011660080260c0860389901c600116601002608087038a901c600116602002604088038b901c600116604002888c901c600116608002010101010101016040028160006006811061026c5761026c6106af565b60200201526101e1565b6040848251018239805192506020810151600180935060fe5b60bf8111156105e257600160601b63ffffffff60c01b031983600209600160601b63ffffffff60c01b0319818209600160601b63ffffffff60c01b0319818909600160601b63ffffffff60c01b03198284099250600160601b63ffffffff60c01b031980600160601b63ffffffff60c01b03198a8c08600160601b63ffffffff60c01b03198b600160601b63ffffffff60c01b0319038d0809600309600160601b63ffffffff60c01b03198685099550600160601b63ffffffff60c01b03198984099850600160601b63ffffffff60c01b031980836002600160601b0363ffffffff60c01b031909600160601b63ffffffff60c01b0319838409089950600160601b63ffffffff60c01b03198083600160601b63ffffffff60c01b0319038c0882099250600160601b63ffffffff60c01b031983600160601b63ffffffff60c01b031989870908965060018d861c1660091b60018d871c16600d1b01905060408503945060018d861c1660081b60018d871c16600c1b018101905060408503945060018d861c1660071b60018d871c16600b1b018101905060408503945060018d861c1660061b60018d871c16600a1b0181019050806104655786600160601b63ffffffff60c01b0319039650505050506105da565b60408b82018939600160601b63ffffffff60c01b031987600160601b63ffffffff60c01b03198860208c015109089150600160601b63ffffffff60c01b03198a600160601b63ffffffff60c01b031903600160601b63ffffffff60c01b03198b8b5109089250600160601b63ffffffff60c01b03198384099050600160601b63ffffffff60c01b03198382099350600160601b63ffffffff60c01b0319818a099250600160601b63ffffffff60c01b03198487099550600160601b63ffffffff60c01b0319818b09600160601b63ffffffff60c01b031980826002600160601b0363ffffffff60c01b031909600160601b63ffffffff60c01b031987600160601b63ffffffff60c01b031903600160601b63ffffffff60c01b031987880908089150600160601b63ffffffff60c01b031980868a09600160601b63ffffffff60c01b031985600160601b63ffffffff60c01b031986600160601b63ffffffff60c01b03190386080908919a5092985095505050505b60bf0161028f565b50505081606082015260208152602080820152602060408201526002600160601b0363ffffffff60c01b03196080820152600160601b63ffffffff60c01b031960a082015260208160c08360006005600019f161063e57600080fd5b80519150600160601b63ffffffff60c01b03198284099695505050505050565b6040518060c001604052806006906020820280368337509192915050565b6000806060838503121561068f57600080fd5b82359150836060840111156106a357600080fd5b50926020919091019150565b634e487b7160e01b600052603260045260246000fdfeffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551a26469706673582212204cd43249ad93606c935ad4e5fae69d4cb359a8563ac399831710cafed075d7f264736f6c6343000814003300000000000000000000000000000000000000000000000000000000000000009a8295d6f225e4f07313e2e1440ab76e26d4c6ed2d1eb4cbaa84827c8b7caa8d6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f50fa822bc2811aaa58492592e326e25de29493baaad651f7e90e75cb48e14db63bff44ae8f5dba80d6f4ad4bcb3df188b34b1a65050fe82f5e41124545f462ee7300a4bbc89d6726fb257c0de95e02789e96c98fd0d35f1fa93391ce2097992af72aac7e0d09b46447f1ddb25ff1e3c6f5bb1eeada9d806a5aa54a291c08127a0447d739beedb5e67fb982fd588c6766efc35ff7dc297eac357c84fc9d789bd852d4825ab834131eee12e9d953a4aaff73d349b95a7fae5000c7e33c972e25b32ef9519328a9c72ffddc6068bb91dfc60ef7fbd2b1a0a11b713949c932a1d367f611e9fc37dbb2c9bc1ee9807022c219c23183b0895ca1740196035a77376d8a8550663797b51f5d87dea6482e11238bf2936df5ec6c9bc36cae2b1920b57f4bc157164848aecb8510afa40018d9d50e59fb3d576dbdefbe144ffe216348a964ceb5d7745b21141eaa2e8f483f43e43917ccd84e70d715f26e48ecafffc5cde01eafd72ebdbecc17b0990e6a158006cee85f22cfe2844b645cac917e2731a3479a6d39677a78492762736ff8344315fc596439591a3c6b94a6cf20ffb313728be674f84749b0b881666b8babd2d27ecdf824a920c2284059bf2bab833c357f5f44e769e7672c9ddad31855f7db8c7fedb74e02f080203a56b2df48c04677c8a3e42b99082de8306631ec0057206947281fb9ae16f3b9122a5a4c36165b824bbb078878ef61c6ce04d7fdc1ca008a1c478d1f89e799c0ce1316ef95150dda868b9b6cb3f5d7b72c321de53142c12309def6ace570ebde08d4f9c62b9121fe0d9760c88bc4d716b1287595c5220812ffcae5b82dd5bd54fb4967f991ed2c31a3573dd5ddea3f3901dc618d1b5b39c04e6aa7c8181f4df2564f33a57bf635f48aca868f344af6b317466efe0a423083e49f343a0a28c42ba792fe96a79fb3e72ad0c31b9c405f8540a20604ed93c24d67ff3668bfc2271f5c626cdfe17db3fb24d4a4052bf4b6f461db9663c62c3edbad7a00d1a10144ec39c28d36b4789a2582e7ffecf4d5190b0fc61862be6bd71d70cc8e724f33999bfcc5b235a27c3188d25eb1eddbae2c802e41a123202a8f62bff7aafdf5cc08526a7a474346c10a1d4cfac43104d86560ebcfc0c45f45273db33a036e06b7e4c7019178fa0af2dd603f844b48e26b484f7a21c0a4a46fb6aaf363a66b0de3225c4744b9615b5110d1d78e5fac015404d4d3dab64131bcdfed6f668c004e4048b7b0f9806ebb0f621a01b2d40649802cbb8b049aa001f8491185e2d32c865f995d18e0f913a874899727352def435be86f52522de84cd642fc59a00fe5e02c86763c4fdf204991f9331646f1cd0635230d1a165164924ac6b793b645aadfece6f4288333ad86914f0468752e5782722987e046a1ac44dafac91a2563aaf92355e853e62aead458906b45eade969091d706ec23b08bd22100afed76aebe6b2c3fa6195ef8efca1df0c3ef6a0319e8441c1bee3404833ec1d8b3799f082a84e5fa4f6f0afa4e12237f45b9f828b9b01522a466a5a2259eb13708724a53cb63cc05079ac6723b7800e18ab21ab6ab9aeab4248de8333764c2f73d45c82550df8cfcc0b2a3a3f7fe89155c252b1d5e2cbc55d6a65c2b646edf083433fe6344082fadefd68105e299bfd9e2d1168342a24bf7f69f2057e32c25cd659e58b95416d5bd4c30ce3217b196fa0dab09b6c61e5a945354343d30902a780262bfa4b12ede816002309d9d9738c9d5839138f6f605a0432e8248791a327cd02d125faa0c3254876dd1b8516ff36fe43819ac6b476ec61ba83627be83a0d67c8890570967dc5d8464906dd140daf00946743d17c2ec7b2839cf1e73782be88f63ec366b9c0ae570215a2f2fc01703ebe903476c62e487e8f2608cd22c6a6137275d014218783047ed659564116fab01b72763615118c1e771fc070b29ecdcc558a54a0f5fed4a32b65f4605bc62156621d4e3be59e3acfc5cb6e14e7cafbed7d505806d71023d62df44e14a28e652cdb70294ae413a8e5da4602c1e5e8d21fd4e875c453ef4463a7ea7ba772d24fd522117e7fa07507a1241d976425ac93b865430ab6b5b44a0789ce6e573d0a8b8033c962dace0cbf1351c595bc1a9fee6d0d4822133041910bdc9ba8c7a4f14d3c9f81e22798d93bdc4782cb02090571fc772ac2e7863432ee3eba7869ccc300d7f224b391b27a50ccaf1d5d5ffb10c0a88992af8c3008b100dbab88682d11a389acda69e96d61abd28afeecea04d2d0fc145c09e82a66bae887b45a837fe6402db4c79cf543e625efc1c08b9a7862e59dc13fa54dcec253573f714349dd9ae4c1e0dbb0f387e5c9f643ed7612a71662623c1c95d32b8fd5a17beca7a3bcdc91745e435153abf385c190457352e9b1fce4840036ead46ad82465af61daf7260e092d08f1b5a0842a023f9f729a2fa35bab5388317783bed8d75ce9f90b706cd41941ad1917c0308a2a1ca360ed9452a36c160c59cb041031dfce06ad42e222d0eacc32edb5340bad34a4135c3db789a4e6c4410b237cc712ca9c4091a428e4450cadc28fa0aaeb29a943d0d166cd325281e2f5daaeb043712b5cd5b941a0397e22553a76c37f26bbb21b250a47eb5814a0139c6f41acddc9b6571c1219a19d44c6ec7f4e8741aef90487348b752849e9deeabb0618bfc4c2469a3206a993d4079c123476b1bc217b9c82ae01d9449511768af5d17f2e1b18cd9fadad2b0c19249bd86ba32cd1d76b1e21dc4febfbf26c86caa8182718be2894b709c041976aea6929b42a5881bdbab423540e347144b57567e45b7842b7d49413cda26f88693569ef907de9bdbdab45ceb3d087cf6980808c1568336a4993132bc9361b621797406962769c28e39e68f3d950f46aef2d0fe28ae6159d7f372f755950a70e9ef09808d27f9d18be13d1a49794b506f0325150569acbe59023fcd23b455db1414568e46ee79ace60d70c4968b4fbedcbb40eeca887e8d44996230e359338740a1efde0188100043845caaa9fa651031f15a00ece4776ecdae363d2e07f54f3a01fc9520ef299f66b20d9821fdf381af1fa5fc3f165c90dfe5276ef3d4c3e4d98a5f90bf09cbf87926d0fe776e8b0fa66bfe925c59a6093fa56e3c560a34c2a2d87000df94ee55f962973ccfba9087a54e543fb1aa7e58f4a5606bfcead6d094b9fb8009e80a7806dfdc18e6a30ead72680776ee509d7366f557afe633f3a6b675e03920a0725c185806f67805947c541752a42c118fef7ebcab74a997e3918d5999025fa09e85fb45e7a5711f82f928438851acc5f4bb039b3c3d1dd4fd26d63167fe682d813f197fe6401da63a0911af8de05e577aecbbcdfdf11d0d4ade83fcba7f62d01b10f1d7be9fc5f6aadb6dc2870d9287a00e06f68683eea5e0a6e702784d90ecd9b615191bd0b115d78c6a48846ac92862f3889aa06843deb9b02b874e9c039d7c80c2606ce2fca5262b46395c97fc90a29aa9d0fde99b2669cf98b7d9cfdf44d4351fcb239ee3f951ea3c29c35181e8e008c2fb0f6ff1089553e2302f5afc5db241f31f6bbee77ec7e616fe430b97cead975ace4c6944e6c7bcadb82a155b310cd577c0fab342096b3f4aae8cb298216a8443975f7be07ead978e475fba55d80f1c315a58039de37394fb584a3cecb091944f18f6831c659728811d17b94fe5d1e82d99ddd2f430ce537dd5a8eb81b7df62fa1beff9a539caee7c75639c76ca4c04e8c8267be723b80edc2ed18e20356134334a826b71c12c1a83a17714e95e907983ada9f1d05125111c61de7ad4a80e6f25cc2982fd415bcc83960bc4f58f94bedebda4471d2c464b054104f9de3a4971c0b20fd5cdfeb85cbcbaeb9df420e818c52bc691b9a4b6312bf4eaaabf1af3b49521c96633cc6fda5d20de232561c6e976eb9b84d959450e4e59fa29bea176f1a2c465bee4447640b1deef3e3b298bd7ecf92dc1bc9d1e64d756d855b3d888488b3dd5bffa711ce47170556251fba86cb3e52c9002d37e3ae38183ee23d384f31520d719e8f5daa8b1f4eb089e546d4b19ed2ed119033347a08844ec3c3de77ec7bfcae737ed381715da748d4a400fe1b76b35310a647924646db3c9d9a8ef2be04f3b01b53f46de2ab6205f91ec318b0ea492ec3277473d9b751f7a0cf8e8e7d3fb45b0e52edefdc488b2c4d219401684963aa452d8b6bbf4bec16bc47fc4dfbb162b40ae45146c0b58bfab95909d54f328ad6380eb6a7092a3505ffd93ff035b425cef9cdd35b06c840ca212b730ec79c03fb1b4b4ca965ea11aee0362c41f8d2688687f8b403e772943a9b36783d4555d5ed37068ea60d4c3fd62054f6064d0549177da2816a0da12b97422e838345975a979329a96c55bca05764adc4bf5ea001a32543b5953dde51509c1b6842a328bbd1c258a510d12002ab2af51e939f3c1fce91541d58380d88a0b46e5ba0a6a2bcbde2767ce37a4317c6de5668f01ccb8b32983333c159f4a5d79ba887357d2901e06e5672cde34500dd733fccd4847490d69e0e682849439ce76a15a839b54bfa53ee2d1222f7bbd91a50634e56c3f2c8d886941543c049cdd77a5ec39f2c4fb8b57dfbb086a44db61dca728d39f19fcd9b69ea2c4ee898fe8b93f6536849be571411cc73c32c4312f214ab610f1b1b1899013db4e98f52b8986dec95762632f8f943403fdb6b7e826c02a8adff0c3124d520581f4911333cadef03c851c016c4d8e924424aada2d0e05c16aa853da7f104781967a47bfe967ea1a2dd1cb121790f11b27f0ec8236a72f3fc94053a045d319f56ed323f4460bd4c99054b705f6050041b5e2d84e7fde35fbc756ddb4526a18c8557b759eb715821160f66e7c44ee0bbfb69ab0ade0e2399c3e8b0469bae1efc3550887e1363e17ee43651e8bf1213ceee515e80ce1e976ffdcdab2e079ee81734dce39591a953c19a36737b51f2b28ba2e979b620d02b326d64a0694cfe8584d139c7e1e28e753dbec6100ed08d217e308e4df2e03bdf1260da176b3f73c65870b32a557905dd711e1f169ae72d061f4c313ddf12b6b63dfec97bb67f7042e62bdc6aeac9a0e34087be9facb621924063326cdb2578899532e54caf53580fee3518e2996f3ea6054a85bd33e88fe57fbdf2ecf3e60e8f1aab3344aa032fa53a42e99c3a12a150c5ad93e3286e501e736617d33a21e9689223eed789513a23a3204208ea7856e799a50675ff2a2a9213d1c409d61600673efb64da1d49b7a28d96c81a3b7a24405eaca50d54dbd8ba9b18681f66aa0a5f00440a4686e1091f99f2d2fab1dcefad047b049144759929f1ea7560342fd4df311ab9e978a1b7f3a9b95a9fc67c86cba72a22f2da7eaf230124f7785b5b383f3ebafc6a3ec4c0f492ce73cc5315d909c24c6f52609935c67981f8a17d88c9ac4015674e1673f72ea5df1db12e236393fb4e719bea650cf68b55047c6834eb148b069fedf02aab376c6c078264cab661b306dab5615cff5d1ac8a0ad4b3813f673e9a4d0b2b538244c2ef9cd6b9cdce29076d2bec58d80268e7eb839c50d9fa46a412e42a0b3397e0f32e505ace7526ff8e61f2ee65061ea5864e101f3396f2dfdbf197a979631fa10f07b353ea94aebe0e34b14589528941c8ac868508e1b38456a2629b6675a2c2bc3e97303173e678fc949648ea43905cb570ea095566e2200270be994f938897d58026bc80c367328254ebc6282f107060afc32466857c04d361ee6b6f37a09cc22bf7a12a54e61917315784494807e8173716bf882bd08d00dfca7bdde7907f132385b373d140a80fc076229a8ddcbe6230c1d31e55ad34a679828916ee148026f97e5459a8148d838bd82faad566e4c353ef258aa9c1c017e43bd0873e94d8c995e95b84fc80adb38dcd575ab2d3f07cfeb57cd93a66e4653ea185369788f18f87432b6a53a6761aa0b7a22136457aa8e22f0b2e9378086c303519aba9a7d052cc63bc65b4742f775aac2a503f7f2a99379179a974c1bda895b22175ba7148778ec84b9858b146f78a661eaf126c44325ea5281c970e9cb2a3933b28365c9151fa812c2e8fb15305895f2edfba23d9b59768b6e19b13528aca472ce9dc65ee84aa04a082402ee2728920f522f51095db20d2101bfec45d7397cd734fd2206064a2224948a86a6f039f7843a95f1dafac9ebfeb36be9f98d0ffe9062580a8dec55aa40841d309efc9e75cbefaa87fcf16ee0859d8627bcb620ced7a403b3c359f0164d1365df61df752694b0c86ad1eafb29815f4b3a1149845c6ffd96f5d09f1bc2e676e11f86a665a73e554d28b42cd3f25a872df5e1e1cd7c8313f76ae7f218ec8d731c09c70f41c5e87eec6a5ec9038cbc961c90c761a688450b77577007bd1bada62d9ae581f085b9ab702f7b9ce51105dedb7210fb0bea3d928e53a7618af3e1b928a32c48d0673cd25add48f537376db3606adf0359797fd53056895196dc43f779efa8f2ff55dfe717bd477db1ce7e86ad807ba26761f46ff9e81aaf89aa2d984f39a603446472a9bc2810b2d581694f543ef4af1309d6db23f18b1f3b991bf23eaa7ab469aae028d0f725766477836ec64e8112675ea678948da895846c0779e6966ec024a77721e82735ebd63289abc633dd95551bddf7a31158f4d76801c7f6f7aba09d8c0c6fee514763bd3e3aaebe8cf1869b8878f1633eeb622710485a80725cc349bf2d698ed4eb15eab798f00c3e52af86c697ae11215ed193d05764aaf5a014acbf5b0dff4def6dab945a0ae6c2550963f78ecbf91d9bb4d9dfdaccb370e36d7f841320b4a3a17af35a111a03351a25b9bbeb74f3576702d5c52013a3fe7cf56cef58ecc3c5ad888dfe6c15a7f0f38c0962160099a5cf1485fdf3509900d3dcc4bd8a3e961457fd95c8f0e443560f2c5da400f12be901e6e178e09bbdad40a1e35a72faa1b2199466cb4c83f4b64f318076393dd35ee7655cc2f3a89a5f74d5b8f6a6984c27dbb608c50a4ec897012d9bad749bfacbd21f9a66d9b51a65cba81eec0b0d8ea5d411a56590fd3b378a5bf6f439a6383360d99304664101ede4026f89ebe248925e760f5e70f434628773e14d2858435138194063be69624d63c001e7c6d7405eb26c0288db86dbcac4236341bfb9c906ac838da161a8846f3b1ecaec1379522770cbd6b26bd9a495d68ef3c7fb42ad858cdf3466c7aaaf15a1790cb9e69b5c65b550d59646848aca900c21cca59e2b5aacaf04810128989dd3cea9bb61911f514b2394260825fd26ae69228e19a35f30f1dcddbe38ea77e1625e42b3bf22d210e95090480a882a38b48a6076026a1e25f1eeebd8bcbd95bdad2ab7a458c48fef632408c6eab3aa9ed3b6df31d6c0fb6d29fb4ab1fb664c20550cd7aa177c61a4194ba21f7a9f6e8f5b7c45d6fa328223f32166ae17a1e95cb1f0230d37bbaad478717c7f7f65ed07a7b747391ee2b35007faa55bf766bff328071261c964452c50c056e9cb0ead0e73ac35f9ec5604d476540ff3078c3821f1a15e45938a90dc6ab8ed21dd5ad02fb6c4b9a67313e0d1327530040971d24cd7342371820aa1c7f09c93959046be3b02d4b7cec8fda20953b4c474beffa82c0fa970ccd7726f871a6fc9d2cbe385363587aa72f3950d89a288fa7b4c6e572e0c8407f639205cabbcd5dcd7a446c96ebdb8494a9a48a931749bb44a01908478217045073f774bc8fe1d20c6966b107d4c35e842efff23c21310f7f18b3586b5f5daba6d1ea77ffdb0fc847fce27bd66c889bcf7c185a9b15c0e6547eedb26eff23061f1553c70472ac170de388724734602c7cd8346a3b118ad6c9715433437d029db59955484f8ada59406149c41179e1c7e6e5da5a67738e73223dedb75387906232bfe65dbd9454bff1a060de55baa52a08c1f9b9b2adbee824f2a93e797efdaa41e994f213503d32c0f1c058665bd93e4c4eefe68f6997de33a6906e312b702c65a1ab65250f92318f354bc36190f2c76acdd5ce117ac3f33352caec78382d67fa93750e13b71d0d7701380a74fe21840b280825f17c70b94e655b107728280122f25d5fedbff93dff0d5f70beddf02fae543f6cb83aebfd48cadcaed8d7248a3f4af84e4c693c5ae3683de302d0b0e295d0df62b7d21d0430448bfba4aaa3ff9c73bd19d44cef8ceff05565bf92cf24fd838d8d220b08f880312e97596096b71e58f5d1878ceb0ebf2e5689a30544e4d0a18e38aef5743de6aee8f39732acfaad60f4e7114eba3a3b5bf7e43094eb53b148df50748e52b116d2a8c0283b20f6af3dd4c24628d56111531d5c15ff2446e3e59cd888c152423346c0368e79e560d0e4b8598c30d735bc058a6c39ce3747893f1f37fe55bfc6f2d697ef2fbb4e1a2e3b9867ff502b1dbc0d3f08cb523e38deb29ae9ab1529fd7b659f3a56d211190a32ba3893add92e12cbc724f208248c5e5bed898db7e42cce84d4cf2d8c1d5f284eb07ddfae25454b47012b8824ba274dbec72e82995229c055f34219f061f41e7004144c7a53ba828c2a017f384aecc7caf910ec2105e6dd336781b3b8952945874d3eaba2902790ffcc5847e7a02fcebdbedbf04f40d0b615c0621c6121fc9273b436a6b3ffb975793fb477e888ce539f7acb389343ac4fcfef0beb5a13fa92d675950f78ff5d8057021b54835298bfc3e92e2138823e526ffb5409527228daf8b17206c48558ba57a0a29eadfd747dbba0b0e4d26326f562820073018af7877ce70104178bab02eeba31133472d2821eee877dac126d96d18aac7befaad984065af0b466bd1984c4c7645caf4e2d5baed2a897a75a207ddab542b2a1898724119c918cd7a5ee005c1837e86233b2c7f04411a4f53084d91047a5db4adc3a11d4ab963eb2655e4913e2702879b51c59804e24e16e67611d62d3098d9ac37c3ba1a58b54c4bdec083cc6f4560db3a49b2e65435a11b9554cff96c90614f343cc94e78b48b5c80b45af0f665cdac0a37fa12584f07773ab6397ce5371d4db6ec34247924e4080f77f76b28aaebcf37529f04bf7998c135b9ea884859e9ea67d602db2a8c696f81e0acff0538daf6b5bc82a817c53b4afa228c7b00253b7e074c04ff5acd8cb541c59bb7a2819225ad239f0a68004d5ee33918851e682bcfdd818c84cd0dae4207e9c9c99381c0ddb968a77059864e8f6da2d3e804b4be05f73cebfa0d1fb326a9695a5f2b35766fd553d1dcf19590e300aec1c8f2ff15d5f79d53f6aa6c766b7e1bb698ff4d072830cdac0bb8f6650280657ccc788bbcb4fb64fa6d83d44dfeb39c485a7e3bf492455401771fff49902f56459502669d4ecd5d488fb91da2a785335a2afcc311c7e4fd356713f53ea9e138662a6ae7e0d6d6dd46f4f7ea3ee67d2d96e1b781ca96a293763359dbe283193cf462b30058cbe18c8a88004dfb412204c4e317cd62cd316d7a607c6b894b13e4be79b39c739407d3d3dae90033b8d074fe21f8b90c25831812412347b92eea1f1f99ae3d998c00bbda4a231a396abba9ded6c77abc60da29ef70280c96d09ddc58ee5dd364303d643780c9b5591f4e8e3941da14bab7732dcfcbece3045d2fd2645e4c1223ee16f92ea54ff2ede716850097428a51f8be2db3b7d478d9beff7121ea26d6f006c49b63592cf28853e7aaaddf770464f1309c6edafdc968bb9de329c9760daf0d3da0c2971ef73eb4dbf1b6dddc2e4de33b471e47bae9db57408e0c183c214ccaaacf631a48109584efe919cb5d9361e8036fbb8d78ce3e2bb5f71736c35f38e416422fbe0724cd4e48047adfaecf10c67a359cf569272081abe7e726dab3658b0df9e85369695aff26dd451401f609d628f6925c2ed1b158f1cd04457c1c89382803d96fbe6dca22d6b50a2e93ab3644d47c2973ca14540c27542c936e1f1144e22bf3b763002fca50eb95e8dbe904e4b35939ac710aafd56f9083d87107f3ef51230c141b2e1c36cf5646afff529f3b6d96d99ffd2afbfbb6a5d76822c18749e2cdecfc588e6a9a2a85444c685b55abcb6b6ecce63586bcc241fce06be327849af57a1ef02293213d78078848d04b216415b0e5174b552efe885ade8b0ee4eed07deb9c40d7d8df863eeac6c0bb019d30c52991dafdf56c777205b6de27ad571bc5d71b1fdb242c7d097614e2004d295587fa709cb105cd94c74b992f2543cb999d81fa4d9f685ecee732fd16c1619c7bcdf544e2a633091ed678c95c2dce3fbc4c42aa10e330e4888538c675f1daf8f87b04957e1f617727880523f8385cc65d238aef8c82de113538b838abc7c3dc3d8e9a62eb3404127af5210af105b47106e3e836519a3236f6e37ee22bd674b418a69c45e007f8feaf2022db553c7550ca009736e3a72ef44753302e8a7fa923efdf05a90d70a0d735ada15d1f7ff6f6dc59a9926e2105aa3a094949a61005a51ad2b73fd2f3fd7994261a351c4417d90696e98bfb516225cd48e04e29acc6229c1aa0a9c85cd46b65af3534a83155cce359e4534a8a01f11695cb04a39f5e1820f9378ffee689ab9a8bd3323518ad27624cc77de6b673dfacba40e50c42fd7e4f1ba745f44a5236e191a23c6c4d73ec6492553dc9815ec77e84828fbae49b622e586518410f33a448c4fe193e305827889375185820069d37197f88d80aaecd1e49c73fe6926b97228c13af85fc286064a5beb183d8d32afc57f9772e45f61b57f3c875ae39fc148359d7a47893b351776439e2c995c2ca33c5d730be3c8d3ed208931696634698d30ed43e48786e8396b612137e9a14e03ed37bddbd402df791577844ae927d14fdb63c196d664d6901985a609ca8e6a0dd4bde665f5d05cd1e8d2fbf9ce52471e05e090bd598ffdfe59b19f73e5b6c9a48e40e614884769fe856d573644f87549283c82ff57f5acd2adb58e015a52d8e8d436a30b63a828bf41146d9bc1e8f96b9c9610ac4c8c7759e06fe2c45faca3e6ddd58bcc331e1320566f6f802422c9c36ae16b8db94aeae0c58612644b6d83cc8e57aa0da10ec2b96027f678b163fee582697c3abd350302246feeba9f71e9a9e7452c1341556d10778d7ecc391de1f9a2e2b9f5cbb0e4deb9754175c19d63248216913a77bf7c4e63b87a7a112623197f38fbc234f12f8308b4bb38fc3b8ef7da3842f666033c36416ab1201907c0877eb9c03273bc80cab17e94a366310774a3612103fcfa52b15907667cdd50167b1f5b4840d7f0bdf6db7740e6239a603fab57227916aea92bb2d2b065ed0e361adc5e2098f31cd66ba0c8ae0a032f64be43bdcaf964b205f42182c2267ea07bc7345cba5ab04f622ddbfbf83b411cf667cf4ee051811e0aecf6b2b6d69e83b5a09f854b2c04874d238d59fa1f2ce3e0e50471a6403e4f000671dbe3dd577034240186dd3a92923851496609d8aa40551340a12a973b32fa743ca3016fd11f9068002f9d8db4851e5f5abd961775d2bdb22989e3b72b23b244a8dbd16a47c39463ba91d0620037c97df2684d8865e907b56da2daa7e7b069a3000e2f7f56ce162ac4dd70cb675223fdefd0c31c2e98ee2110c4f31be2b5500b2483db525dfb50a1454becb68d085860eb57e9d9569eb2d3ac87e9403cb45641ed5eb1a5b5899b34e6ed1fc5af1cff0c7c9ad4941e0438de49a17553ed617692cba11a2628791d1c8ed4151748ed2c69049019f0ec4e30e4f9b2bca32e8f6e1f77f0e4faf894c823494f90eda29878dea297328957e930d175373f6a1d872a15ea28992e3b2219a93149e734e0a926ad68195b7445c4b21ce81141dfcd4d4a7bfdc36a4abb834889bb6f109678baf2e10c94ca085b46dfa71f915f253ecd4585aace33fbccecd3bc40f3d7a15e2fe84346ed139e98293d5da54444dc4a8c33c4a5a1093ea5e4a58fbc1ea9b24014912e48412df9db49f77b624d171a24a12c4aec0c793355efb8cdc8cbdfae5c16a1b4584408caa6996c1a7553337e98983cb2c9f478b04b6ab8c4ce00405ad27c0650e74a089cce129d176b8b36e36c421113da53302a88c8a34f52e51fa3bf9588cfa31d165f199f6720749e22e6945cae7659801d6cbbfd3519cdd3a583c613953492c798274170a6d4e3e138b3126dd4f8e4aefbc4911708fb67f3b688d8e6ff3abdc1a3d8d169ef6caf5c09cf098e369125166731aab190898a28386e6d764257223ba52569bd649317128b1e9333ac83edd81bed4ed8b155be83ef54d8172b0194869c52cef02b1791a29e58715652112280a1cbc6c35c11eb4528a5dafb5e505e60ff70554089c9e61ddb0831f7e6c301b32f3dee44405a8310201b2861d53e222ff3c8d94dfaae51da3447b461bfa7a5e5f90851307c2eadcf5af1a9ee46719f2c8fd60f3beee6ef1b55a083d92d79a9e1a7d3214f91775fc1da768851a5619ded406adebf64f49ea167d309bedc6d113a898b1246a78e853fc3aec77efc1ebf9566f8e488006933633a003ae923c6318ad4ae0531219588de99b09630186d9bfa45f2e0eb72e7a9502d97e35c26f8156a428653b89e9a206ad0887a0097eafa1b9573feab45effe507e9269dd1b69ec7eaca8a6c08f2c4ae6d7f58c16b7e977bf774cdf613409092ec15b3d80dbdc36fee17da26031465a2fa4099a569b0cc48ece183069cdb5c2feeddf3f252655ec021899aea51829f2b75977514a38f446e7bc2fef356c9b67c83f1b2d7913918d85cde987b3d27d5e48ddc9987a018343ccb221916d23c1a00976cfc19f97c7dc2b9de8ddb76a0f86fd6cd1e86c7fc4af0e3a979e6270116b705aab7d5ffa2ecbeeff3b69f6100646445b1280570f0037bcee91fb80a1431789544a19b8a82e1cda06638a66ea32561f2faafe5bf9867020af7d178433e53052406e63d675ef5774697b7660c9a169bc30e8b173ff699f7f8927b73b1914f593b0e7fda393cab690b7600cb5507193a552e46819023177d0fb8eb5d49ee2fa1a197dddc337eaded659313df4bad70e700541d46e1bbdabd84d535fc83cebc81b05ddb7360bf4e68b4198126b54448694ffc26531bb7171323ff520cd7cc19b6d9883aa6141ddcc7eab45ae7ebf4e6d076ef50a3673f496fcfd21006550864812479216ef5b614a0f380450a17c0512c3b06c60c2f5b91ab5bf44dbff409efb792e518cbb296e370fdfc376bc8f43489a79c22e1a10dfcc3488829922299a968a291df4cdbf99396519f017b92e42feb656278d10a9d098364e17f5cb7edb901dbb410bab2134fa29b8adbade3d706cbc88cb90eec3898e105b5d18cc75c812202688b0385108f73b2d9a08445765321ecd00850dd12396dbcb5a3b9b7ad23cf7959dd33b38e3f5427b6855ea24019c3810bd0f0928223eb1f35e45280f902c3d070e3eaeb2567b1c8517ece69d839405bfd39512412aee462f7bdcfbb1bd95be79d179a7874bae37eba7863456259917e527536a14fe579495b75750084c16221d07f413fe5d10f517d87e44a748922eec197ee45137d4f86c6c751cffdb50f34f07d6e263842696bcc378176b5c78008d4c1e7444c09c12e38ab9148acd3980b578c3759c8eddc2424a786e478c3afff5764f7a1e878a7aa12d5425126cacfde36b90e99146a9bdf3dcf9e795c8c0d3fe0fbbe4719ee6a20fc8b712f7af424cbf88dbbc4faf65c27eaa5896f9716a3c4fa1d379ac8961a7d2fe1edbe09987986d86206a76543f68ab56409aebbf9787b215fc5000185b2af5eafbf35aeed128d99f9cedf9ef5086e5ccdad94ca7bf69cb58f15f292c0d7a69a583742e4b0c556dfe0b2fe55dc75a4aba4620084b21d4bb55246d645dec7191af5785eb5f6fd87de158cac01b0a3876316b9582bc269df2fe5ee7aaa53ea869179bbefb54ccfcc656cfe5645cb0e136a6bb53f6aa2a94ccff8ad442275c8bbe630d37cfc78e74c10ce7c33e42488012525f9184e03a1be5e759666d9cf471af52aa2e1230ad34a52ec59b040a9d943682aa28dc32fe79ae4f3113b3d4f9190608f179ea584343eaaeba2f134a0a8ca7e10d313497f11267a183145238b6ab79d5bd21ac5b17c09660724378244a9afa8a3c6e0bd7361ad18dd8e0ff63cb8bc0d07414cb69598e2c7434f59cbd19e79b8267e08fe52cae69ce9082737af123416fc1807ed477997836c9db22c5a53cfba0956f7888421f5147d0df5c5f97f63afd0bc8e0d6809ff3b931f3666468c2801a9ed148522aa3718144b98b2ac449054be669550dd63358f71841f08db73239c00de01a8eefbcc2025f4bddf4c769bc31abee6327e6381fbfbca32111fe75dd59c58de31233cf282f454a9f747b015a2c189375d15d7de28744f136826a200e461a5a55bca29a370b013ad16e12ce00e60192c15bd1511e6573fafec0bcf53883ad566ed0c7ec19a6bc147d3afbebccb5b629cf599c69bbac3430acd0dccf63dc39e8ea80ee2caa89975f6ad353a19c614256279a5b1894bc211d2cbdd6bff87cfb5ecdc3a175823df028f7505c7047f342a5557a160b94609db9ce09a34ec6993ea8a34ddb3ed6856e8d7be8ef79331bf16871de01a42082a1250a54c76c000d1ace84746948da51eeacb173d19c34037d0e7742fb8546c16ff30e049b5b45cb0f4065a2d80fc9867099f71a3cb5ada3b36331a17c106e4a0bee61371e60ac551b11dc4feb0b3caa7c14bda277e649709ad40f0a29edc8b7551175ce48cc1741e553c47b517d98c19e5e1a0b94d3e8700615d17fec5b2ef04682247cc9d72043eaa749812816c27b0ccaecd481b53346dafaa791809a6a903867a5dd4ed1180fb66cde66e43fc05627334c5bcb3ff93cd1f68bacb5dfb8ae3e8ab604344ee655295b9879ef6782b1058c8da6a0e6b9b969acb4de28602071ea96826df92cc8cfb39e9c52f7689ffaac672cafad7ba610d4bfe7c588336be768050b2560b8668f66bc7b12b92fb835a6e2082dccc7192d2d92eabb77737519e6355aa497a7e83240289e78d82b0ffadc8173e4bb7b1d08576a9a9180828e119a9ae0547246bb35f5b18df3dd006f7e4b38e0d976c78b3614d45f15ae7eb676cf421546c74be47754636319165a04dcff76b05f63748c7b29e6d7d59cb548034df86b5d4ca67a7d375c25d7dd27a362fbce1b13d6c563d26a0f524f6094fb525bd53c2bb0f31109414617e6f1ab326a81d7a8d1a1f81c03e69efe3fd8951b0e9a7cd7b8c6c589bb4827d0b1d48463e76c1826eda27cb447c1fe0abd8bcae4106660903e92b89ecb4330abc7875594c978e9d94b8bf527bdc317496d03c27f85ef1800e82f3ef36a3c08f18903cd573b489faa80815fcb24c5211d838dde848fbf5bd0bb439e8f21d579db4a3270d5f27fe57f4445a91ae92eebb6d0357cf66f7036a6cc3335689b05d2b0818c34d2705992dbca369995ceb65050874e337bcaf6f32945c0d2af0b011290c59076c0979ffdff84d1a4f59de631697319d70af323294e6bd1b15d5d3a7a5905a2b70ef9bccc8e4939ab617f4f46cc45a4f8ad4aa5342c3a65677c3d034875882d5af65ce928cd2fb7a5247cda74d7aab219f37f8eb4eaff4d51aa90559e3a968c9fe86c9b0d615b8c825c9104ce91af3a69c3aa389555ea141f362802fbdda369fec2cff916d9c0734396594d7841a69cefcf93aa1d00cd5f03d325ee6f3747e480d71f8f4d37cdb852ab5480a0a6d3225bada15dca4fbc766d8d71d4681a20bc0e8080583f79070a931d09967ff628c42aa9d646db991bfb6e451b96bb87338a2ad5df11231a6ae94791f956c4196f3044689d8993e2cf68a5c4bf93fae7b1d525585cfb4c37da11087f4428138376d9cc95bdbfaa75b95c34159239452596f3906c9c185df8bf6bcd8210d620c0853582b82041daf5ff17635b60776c47c66668928f14623b58580fcf85019d9d2c256c2d21dadd6f194da84e970ada489fe2e4146f2336d45c9cf5d236f92291ad11e7d0c4982668d8e80b958f267a7545f1eb8643878f4d16f87aa60af8f722b46d91a965a4526bdd285637031a973930527d0d5805b6a87c7bcdf4e4d80143debaeb4134810f32e4ae3db3e133933e66f926d8a04d08647403d7172fa270f37d5885ddd1b2161e77ed927541ea2ad62181d0c5e7b270b009d447e9e9935bbcbc41d5b3c10673e53083f0cdb365bde6ae914234ea9dba78a63d1f258df1b2a288ad02573c47ada135173a662fff5ded79f55cb0d7b7fe9278492e087ff9387f28bba643f839a2bd4410b6adb624534c904fcabb951ff95f8fcdd7c79c8e2c62ca1e433795775a419670bbd4042ebec1fc9f55d18aa9f734979c8f81caad53dbfefc28bd11653939ed74c030f07b32c75606081efa0b3181545a45839f0f5eee99ad533e0544a2fb52959135b753a38697f3f8336f2d9c59df714f760931c9a6541cbb7969b89613a4326e1f6c255ed4d9e630ced835a9a43daf8cc36151866f6fd30b84d8e9ee96a1004c03b6ba8bce4dabe9915359a9740996fad37d7c2192ff5c850521efde7311440cf0a26ac8b8b0de9c5111bc7506527e0212b6254a1b085ddc69a55cc1f327c042c0300c886273573ba039da8db25f42f915796257d7f7bf5d01665e9e3950042bd453fb8b65fdf1121f8eb7bdecaa6033d5a3b0fa9ad4d084ae228c642149a3369d6b1dcc993f51b9acae205683f23476a6d931e27f7f4e21b26df9d3d5ed236aa6e32dfed72c919b01c8ab7939db9f24fc17209c600abd9c27628775dc89c0a707262f3b695d3d95588fb54e191f06fd5d61ebd4ef2a5be038242f07dc672dac847cbf18872b8b5a7393a3a36a4bd86b1a945b42bf8d902120d89159438f4642b864dc08d44f8d7d438cb815ef764d2d5f75e63a48b022f7b80c3b4efcf64029599fb6f8b3ddba1cda55aac0aaa0bbd02df397db13689d326c8121a3a7295e399c6fd58b494b9ea5b4caa730da007df7f7d10202268cd212b1f94af40ed2749ed8b214bb48d6da609ff06d0f82cdf6ea7a2cacc62560ea92f8df821fa557c6ed64dbd9ad2f624a3fc92ffd58b7bab15913aca6c69704993988c5213846c650ae27a9420866e92a67d908aa4da9733984cfe102321d28dd9a2f1d65bbcf4282276671c639c649363c8fec0a65f9c65ccffc091d2aed614ab9f7830fac41866bc05aa161b3f4fe9f37e402eccfb4ee82623fbbd71a40700547fd07c0412d4465a2e228cb93fb418ac870ee06704771f4ea2ff3603c65cd692a28e51923caee91fb75a7870410c5a6516bec32437d00c5b21882103f161fcc439057870c09df692fcd9e1f87763de632c69a50c6d0efa48c76573571fe690c37925544c5c5732e241be80403500ce81835279635d1704db3dc67b124cd3e879f2f4701cd5468dbec8dbfd7e32e9e0eb7911582373f9a8e618ff8518cc159de9464e5decba503e64a6898c48ca3c61d5f9fa1eb18bf42d7360e656ea985323b3f70999d3297d0ff965118a7f2cdecba89d23ef105d58b3a6105929964dbcf47772d95fb30d4e4e33bda411b87e1dbfd4ccbc039d47bdb099c859539e8094065a217cd40af84495657ae8eafb8bf822d4b5d3453a45426ab8173c6c30673166be5179bdec40a2a6823dae81c005da3d3f19f16fc1f8b637a6f3b2bbdfcc4069049fc2bc9bb668e9fe7099421c26f238ec625de5d69dddbb657797463478746ad6ae858eaf00cd21bd6055e04ef4c4bdaa1bee156a174e4e73c65924e2b4bc603129aedc5f7e0d092b651d5078e5e4b745cf2e79906f499d60a6fb2a09546672448f76ba7f979bb8cd34ef0942ef2eed480ac8105ba4724cc7592bbcbb7f7fa3b14688d74da2fe7da89b4eb463ab5fd46dcf050ac1a4a3e85d32c8ccbd315cbfc941c26efbab986f337afb0444e8cd618ee997d9a0cd25ce1052b40bf3e6c5b9f0ecd50380bf6126b5830e703a09fb559d56d6665b16e882819d9b0cde8943b5432b7f362dfb5298b60c5c8849ffb27697309fd9209f39d0611c5060c05061406acf13050a65bd1169c6c02ad7216e0d2449b11e88d8c033bd814b32be2eec3c01043d3ff1fa705146508843623ff4f8cefce7fc512f96bb6faf65922f324392c6196fbd54466946dd00230adae95ca6f59f385a4a02461bcaa6adc4dc2ebef575357022fc92c1856e6257d5dc1ca33037065a3097428ff3d9c54baae5e3c76631b35d2aeb6161742d52f476a9aa5affcca813c9815b7702d3706219eebd95dcfc5ca9a6976418b43959d3941090c0d0e2662bce176f74a87a13b6a115d371b23dd8be05e4cc9924da0065fc8cd5a45a1d4081ecbd40d88175fd5e04b8e3982b3e2e7bdfb0a6c4a9e7d603eea3cb05b50d7a4629b78b3b4561f09b9d78a2431dba81cd3c932a0c397a72ec347bb4b25605b56f40c6bf1360be8f408d17ad76932747a02ba3ab4f8c7cdf64692f569882d2e3e86fd2219e702cf78454634ce53fd788981a3725ffb70634248a9cbd881a8fb42e7ee472b8c9033a3be3b8bd932e620e9bf4508d49dd47870031f25584278728c31116560a4dcf0602121b0a1b834ecfd6d0e622a150a8f3c4fddd3eb2653c71046b3ed6614cfbf879b55890ee945813ebcef02409118d2e899e26d19308a93d59a904b903dc95299917096aa1b2facae48848f6da257fe82a2b002097efda686f8081c9ca10e5c96564605d810898a7cbf16f974f99417b66ae3c73ca30e092a962a4556eda50481f7b862c0344b489fc31eaa35cbd531705a972d147149bb58ebaa58e8f1ff282487c7f9c601736e3bd606bea4147ebf1af6e9a4805cc2d6f1c3efa8f5b3801c9366d52c9be39e8534feb5fe4621f8c1ff2aff18a680d11fd4ec42c7bda2a3f710d08ebb6358ade012a6d2410e05e44265608c3b9be70abddf7ffe49b004a48416220ce1f49505831199174f4821c2b6da9d8f07970251e0d184c32080b407dd5b30e40cb4085afaff4beebb91a0911d2e708d7b89bf66c4a5fbf55bae201b1dbfb9692794fdada00a42ccf620c19d51aa96db5197702560563d6c1029f3cc4ca3324c1a5efaf9fd7ae2ed2eff2fe12d29936821f9b12ce0dc7b439b0e348457ea540169a1b66631150d28c806d68d581a5afb4f94023386ddc33f070e0b4f28e222237047283eb3353391908340c3bb685492f437938d9bb70a71b41eae4d23db86919277b18ab7efa72df20ce7d38f3fc2488a43757bd6bddbc3d316c1e08c8621734a1a4b7586a685e1b33510ed610975a6094d7f1b8b9b00b6fb4ff5bc7b4915a56fcfd0f6b9b89846915902674fe1268f7cb2cda9b49e93e8973f8dd8e806f4b7bbcf3c5321a88bec9f21aa4a3b22967d572b3c35f094fa62e3710cba284209243717859868e03c9280e40c6c8ba23f7df68e112959a4176a05c015c5f4ce49f8dec73cdba064198aded3b6ce4ffd86d56157bc6f84cfb9988cb78b3727c23abe57b707b220239e6c480edbf9c74466fd421af9b6cc637b0019a20cc3503dad373bce9aa3005a01698de2e83f579d4bdf4f6417b25882062c21da7f05f9e05f1f02c1ff2fed4cfe9fdebc6b840fab6a915158c80caed85163096be26830247e10b65abeb10e7fa98844d400d67ad69d45b1ea269a57b74ceb14b45c5e23fb58ad6a269a6350be85ddfaed755ecd3770061436d8e7ffa080295e46e3d71f8fa1d38e5467dc702ed2648127a8ced8fcdcf3b7d870ed5668792de5ac44d0ba6a8c5722114ec9aa9f0559c35eee4d869e836538010d667009430b4af3a9940eefe7ae32e80d8007e13d75265f8fdaa77d23fe8b7962c044b6254ad7b2e48975a375b4806229df3386793f1a04ef965acea8fd4455a17ca039ddf129b3252722918efdf0320238f7890cde1d00facebc5e3403a6d69c70a0c362355d880d05d85a7e981116dcdfe28e6f5a7701434199a651f9e7db40a97f010898b92b3d7a8deea79c9a25a3f6faa24400ace16f8dd7aed7f2f397e709ce9a8e61481f2ebb522bc7da4ad974c7884a7231eb1ea483e97e409450005a2ba3ee7fc8537669a60fb6d8c7644919037d473638ef9c809051aa292afa238b7085c62b9f88d55670f72ae859ad20f5438354132adf0cccd078bf20670226baf90feed142367da5f7ef359cbcead5ab74cc3b8876b2a9cc5d17688a96b6b6d05cd254cbbc02d8804d53ce14e60ebd03e8615fffb5be717db7f75d246703e5cec8a228ff0e44931caa0cc202535ad5e5e0d322be0f0c30dbd938c5e6f21aa3381ee4c2a9d572e826eb5a1485f4a42f8b72835c347ee8834e0b00641ed7fdaaa8554f10905107f8bbeefd3cc298ccba4d177316ae5495b9eee58a8e492c0baad7eff59a786a2fcc89b3854070258d55dd9bd17aca2a053a4585f9ccf0c974c23fda04ba4f73643b58a8f2c8eab5304b8ae7e5d1441efe2eb541db7512f9eeb484ca673403223b75540de0cebee50a2b612fcdec1826ac1e89c8c434afc9a7f1f7c3543e384f63cc18fc35b1995d800fd82aa9f161637fcc1ca22b48a3b7360ff87276f590279ceea269f14e4b1486bd39ceb43e8b39227969ee2f4bb9f8f6fc43c9ff9db502f3f3eb0c1e5288c0bb4f672351deb17b633e55c391f0f7eb72c2aed5b69439fb7891d1f235771a4e138195ada5c30148283e3380e39c126ebbc8c3f4fb855d0652a8fde836bd281f94c9c080def72d827a792f8b6a7808d271b4205657b36213b0d89c30eb08b59fb96ae4dcfd7fe90699dfd18ae4c294011a19052cf26acbe2fbdebfdaf0e5ccf3fd1bc2c181ec1e30bd14d45bdd42af479bb6067767c6ce7dbd4596bba5490352bf90bc42d12717156f375f061e7fde205ae815092f848569f2b08df7f95d0196d9064e7a20c06ad7e087cf802da0d9bf5fafde13565a90d1940bb6223edf5c2cd5b4cafd33a30acada73f5d5ea2e570670ea8150dfbccd00b2f18d6040d7247f562ed48c61934939ca424df0e1dbfccfe7bfff7e79f2e85af56511a98fc2576ceef9ce38a13adad9279833258fddd7ec99eed0881e4da7155af7cebcf862710affadb8a7ca15735a0d9d32b29837583b53db11f451586d2bbe81aa16efcb761238dfb0c4a647ee9fe31556308ad6b2e3d38182e52c8d19896a55f8cb50929b0584d3002732baaa22347ca443ce4400bfd293a8d0133b9efbdcaae692c6b31a4dbaef3c0bc61cacab1ba5d81708c4681f747d8a615424c401cea3043e34b05d8e66d4fa7cffa052d81c8df4d8b16603bad47ec0cac8a0f8e3341fed9a21ad7ddd2818c7c9f95c3cf0fe285ad98aefa5ec39e8c6be842805fc3cd1b665fad892316fb2a572bae347cc91aa7222caa1ae1e90a750ff2d70a8256798c073a7a535eca655db9ac11a6ee7fc5c5931488140c5966b61c44469450d485c19c1f5896a2300327871eacf424a0671afab04018555ecad4900a44ea0861712354124c375cf1fbda6dcd821c576c192410602678f08f1fecffb11de0386144d1754626f0c4c4bc5fdccfa84f1cf101adf7a6f40752315886054a41d24e05ba4ea1dc17e044ade49d363b7468b7a309adb59c7dcda2e297168a0520a95b428afec64180a03256cc0bd5342a9712a7e378cc9cb27d9570aeb4d050c519774a1f816f8daa02461e54f92722514fb14fa002f6ab385dd500d1464006a2aadc2f5471571d1c260ea1ee5d7fa12197cc6337b962f0da55c3c73a20a7a9967a46e1f61292460974b34e3dc4cd2e353733696dd532f32513e0a444d24055f42396130223cd8e079f1906d271e4251410d6a505c8fc1881a07270fe010b8957184e4c1ece378a820f06e611fb56753ea6aa16d7a9a3ee9690af30e046fb025b6700de1052fe74d44780f79c7356fad7713b791a8fa7a6b11932f5489f1f40f80da49fc76dc1a62f9e93dd894ee92cb39a3d10c5638a19f876fa802623c0ad0a11752894499155e2950572b8a477a880ccdb1d614057338cfdf1bdc3e58b4a41b35c7cc1151d30fe953450291a50d0a5996cc2854c3671725fa1bf09ae035f14ee0e12557bcd6e8aef83543395f39fc4f6aba0d93e31ef027dff278dfdf875cebafe86e8db90439b4008fcdeebb434cf7036b6c91fc7a4ecaec4a329ccf4a64c4aa346cf8c77b7e8220c19270011a6e5d0dd389a7e156246e8eac74848e98ad2c0eeb33bf710fb80e21f9bf3781a812ff5c42fc5c3a1a8b8633e30f7d82d775b430f41ab4e7062523ff04ba75b62995d615a92e70b0f6911d9548dc829e33964289765aa2d798970b4b4270eb3a87996394df088d43d8f0071c3f2e48a615ca3cc5aee410d1e31cf8e69f6d9782fde16d33d6aefe45e9426f2c44cb8d0e4302c857bc8fd0be12b3d77365795f2c2b1427df8f343255db658f1e924ade3085af182dc1c70e7cb035065ad52783a49ebe4f5e3e9de012b8172d7fffecbae05f932c84d11b9e2d733567f4b4f25b71351edc8e6d6db386952169bf021b60d57faa44497ef3487ebc751266df5b8b8158e4491273d038136c66056b248b8181a07ae7a71e7f88c72792ff24af44661304146187104724dae117931867110f98b3f727c2eb570e0ed204bc48b9fb5a99afb709f5d5b9d3ea700c3d628155d6b617a2313aba8889458a5d85f542493431c1ac5083303ebf03ae8b0082939cc2e5262ec899078083c316e7a73fd069292468f6c14fafe64c0f5d39a78b8720958fc04d896b898f3c8d6120e130508a9d3e76b782cca378f6fd289dd106000214e5f4aa8024a795592f4ec2c7a1d15d14774667a534cc4d7378a94f2b51cecbe0bd2512476d38b66dd84eb3518b4330a9a64afd3166370981585fb2b9e171acac14cd7db9df7a687a380d71e1b75f207ebac9158720af5f5c7741509976f5ec6a6cb5473dc12bb425cf56ddc2356b2818d6a7b57ec33c22d51aeb8c39debdb70ddadac9a687535d1ae86bf7f66446dfcf581810104e25195063715b96f72344dd673e8570158d95d205437d0000000000000000000000000000000000000000000000000000000000000071b";

        address deployedPrec;
        assembly {
            deployedPrec := create(
                callvalue(),
                add(precomputationsInitCode, 0x20),
                mload(precomputationsInitCode)
            )
        }

        // Initialize proxy
        WebAuthnAccount proxy = WebAuthnAccount(
            payable(
                new ERC1967Proxy{salt: bytes32(uint256(1))}(
                    address(accountImpl),
                    abi.encodeCall(
                        WebAuthnAccount.initialize,
                        (
                            pubKey,
                            "y09DMuN_PLma6eI0SMTp88vFmZAzYD_CpyCnH8vFMPU",
                            deployedPrec
                        )
                    )
                )
            )
        );

        // Authenticator data and client data JSON (in hex representation) retrieved from the webauthn signature
        bytes
            memory authenticatorDataBase64DecodedHex = hex"64c582611bb7947a158dde1d22111cfbb073a46f933d7c8dc36c5debee6a18f00500000000";
        bytes
            memory clientDataBase64DecodedHex = hex"7b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a22626d397559325579222c226f726967696e223a2268747470733a2f2f776562617574686e2e6775696465222c2263726f73734f726967696e223a66616c73657d";

        uint32 offset = 36; // (72 / 2)

        bytes memory callData = abi.encode(
            authenticatorDataBase64DecodedHex,
            clientDataBase64DecodedHex,
            offset
        );

        vm.startPrank(address(0));

        uint256 res = proxy.validateUserOp(
            UserOperation({
                sender: address(1),
                initCode: "",
                nonce: 1,
                callData: callData,
                callGasLimit: 1,
                verificationGasLimit: 1,
                preVerificationGas: 1,
                maxFeePerGas: 1,
                maxPriorityFeePerGas: 1,
                paymasterAndData: "",
                signature: signature
            }),
            "",
            1
        );

        assertEq(res, 0);
    }
}
