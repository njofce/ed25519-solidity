// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import "openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import "../../src/account/WebAuthnAccount.sol";
import "../../src/static/Structs.sol";

contract WebAuthnAccountTest is Test {
    WebAuthnAccount public accountImpl;

    function setUp() public {
        IEntryPoint entryPoint = IEntryPoint(address(0));
        accountImpl = new WebAuthnAccount(entryPoint);
    }

    function testValidateSignatureForAccount_ValidSignature() public {
        bytes memory signature = abi.encode(
            P256Signature({
                R: 0xa19f56eb6cdfbabc8ff8d12417b76583d17ae5b619c74ac66e4a4c3799276ccc,
                S: 0xc6fc90e70656ed9a2f955ad86d960176b7607bef83278e5481d8ab8eab90950d
            })
        );

        DevicePublicKey memory pubKey = DevicePublicKey({
            x: 0x2a28a6e5ee09b7366a8ae7ecdbc564dddaf74d9d7e69ec07c6c49d7e01f63198,
            y: 0x7229557c0b3ebb52983a711ce15bc7b6c96138e9c1000b0c11143094f9a8d20b
        });

        // Deploy Precomputations for public key - retrieved from the server for the given public key coordinates

        bytes
            memory precomputationsInitCode = hex"608060405234801561001057600080fd5b5060405161477a38038061477a83398101604081905261002f91610037565b600055610050565b60006020828403121561004957600080fd5b5051919050565b61471b8061005f6000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c8063b5cedec81461003b578063f050fc4e14610063575b600080fd5b61004e61004936600461067c565b61007a565b60405190151581526020015b60405180910390f35b61006c60005481565b60405190815260200161005a565b60006100898383600054610090565b9392505050565b6000823515806100af57506000805160206106c6833981519152833510155b806100bc57506020830135155b806100d957506000805160206106c6833981519152602084013510155b156100e657506000610089565b60006100f56020850135610157565b905060006101276000805160206106c68339815191528388096000805160206106c683398151915284883509866101d0565b90506000805160206106c683398151915285356000805160206106c6833981519152038208159695505050505050565b600061016161065e565b60208152602080820152602060408201528260608201527fffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254f60808201526000805160206106c683398151915260a082015260208160c08360006005600019f16101c957600080fd5b5192915050565b6000806101db61065e565b61010091505b80516000036102765760018203915060c0820386901c6001166080830387901c6001166002026040840388901c6001166004028489901c60011660080260c0860389901c600116601002608087038a901c600116602002604088038b901c600116604002888c901c600116608002010101010101016040028160006006811061026c5761026c6106af565b60200201526101e1565b6040848251018239805192506020810151600180935060fe5b60bf8111156105e257600160601b63ffffffff60c01b031983600209600160601b63ffffffff60c01b0319818209600160601b63ffffffff60c01b0319818909600160601b63ffffffff60c01b03198284099250600160601b63ffffffff60c01b031980600160601b63ffffffff60c01b03198a8c08600160601b63ffffffff60c01b03198b600160601b63ffffffff60c01b0319038d0809600309600160601b63ffffffff60c01b03198685099550600160601b63ffffffff60c01b03198984099850600160601b63ffffffff60c01b031980836002600160601b0363ffffffff60c01b031909600160601b63ffffffff60c01b0319838409089950600160601b63ffffffff60c01b03198083600160601b63ffffffff60c01b0319038c0882099250600160601b63ffffffff60c01b031983600160601b63ffffffff60c01b031989870908965060018d861c1660091b60018d871c16600d1b01905060408503945060018d861c1660081b60018d871c16600c1b018101905060408503945060018d861c1660071b60018d871c16600b1b018101905060408503945060018d861c1660061b60018d871c16600a1b0181019050806104655786600160601b63ffffffff60c01b0319039650505050506105da565b60408b82018939600160601b63ffffffff60c01b031987600160601b63ffffffff60c01b03198860208c015109089150600160601b63ffffffff60c01b03198a600160601b63ffffffff60c01b031903600160601b63ffffffff60c01b03198b8b5109089250600160601b63ffffffff60c01b03198384099050600160601b63ffffffff60c01b03198382099350600160601b63ffffffff60c01b0319818a099250600160601b63ffffffff60c01b03198487099550600160601b63ffffffff60c01b0319818b09600160601b63ffffffff60c01b031980826002600160601b0363ffffffff60c01b031909600160601b63ffffffff60c01b031987600160601b63ffffffff60c01b031903600160601b63ffffffff60c01b031987880908089150600160601b63ffffffff60c01b031980868a09600160601b63ffffffff60c01b031985600160601b63ffffffff60c01b031986600160601b63ffffffff60c01b03190386080908919a5092985095505050505b60bf0161028f565b50505081606082015260208152602080820152602060408201526002600160601b0363ffffffff60c01b03196080820152600160601b63ffffffff60c01b031960a082015260208160c08360006005600019f161063e57600080fd5b80519150600160601b63ffffffff60c01b03198284099695505050505050565b6040518060c001604052806006906020820280368337509192915050565b6000806060838503121561068f57600080fd5b82359150836060840111156106a357600080fd5b50926020919091019150565b634e487b7160e01b600052603260045260246000fdfeffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551a26469706673582212204cd43249ad93606c935ad4e5fae69d4cb359a8563ac399831710cafed075d7f264736f6c6343000814003300000000000000000000000000000000000000000000000000000000000000009a8295d6f225e4f07313e2e1440ab76e26d4c6ed2d1eb4cbaa84827c8b7caa8d6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f50fa822bc2811aaa58492592e326e25de29493baaad651f7e90e75cb48e14db63bff44ae8f5dba80d6f4ad4bcb3df188b34b1a65050fe82f5e41124545f462ee7300a4bbc89d6726fb257c0de95e02789e96c98fd0d35f1fa93391ce2097992af72aac7e0d09b46447f1ddb25ff1e3c6f5bb1eeada9d806a5aa54a291c08127a0447d739beedb5e67fb982fd588c6766efc35ff7dc297eac357c84fc9d789bd852d4825ab834131eee12e9d953a4aaff73d349b95a7fae5000c7e33c972e25b32ef9519328a9c72ffddc6068bb91dfc60ef7fbd2b1a0a11b713949c932a1d367f611e9fc37dbb2c9bc1ee9807022c219c23183b0895ca1740196035a77376d8a8550663797b51f5d87dea6482e11238bf2936df5ec6c9bc36cae2b1920b57f4bc157164848aecb8510afa40018d9d50e59fb3d576dbdefbe144ffe216348a964ceb5d7745b21141eaa2e8f483f43e43917ccd84e70d715f26e48ecafffc5cde01eafd72ebdbecc17b0990e6a158006cee85f22cfe2844b645cac917e2731a3479a6d39677a78492762736ff8344315fc596439591a3c6b94a6cf20ffb313728be674f84749b0b881666b8babd2d27ecdf824a920c2284059bf2bab833c357f5f44e769e7672c9ddad31855f7db8c7fedb74e02f080203a56b2df48c04677c8a3e42b99082de8306631ec0057206947281fb9ae16f3b9122a5a4c36165b824bbb078878ef61c6ce04d7fdc1ca008a1c478d1f89e799c0ce1316ef95150dda868b9b6cb3f5d7b72c321de53142c12309def6ace570ebde08d4f9c62b9121fe0d9760c88bc4d716b1287595c5220812ffcae5b82dd5bd54fb4967f991ed2c31a3573dd5ddea3f3901dc618d1b5b39c04e6aa7c8181f4df2564f33a57bf635f48aca868f344af6b317466efe0a423083e49f343a0a28c42ba792fe96a79fb3e72ad0c31b9c405f8540a20604ed93c24d67ff3668bfc2271f5c626cdfe17db3fb24d4a4052bf4b6f461db9663c62c3edbad7a00d1a10144ec39c28d36b4789a2582e7ffecf4d5190b0fc61862be6bd71d70cc8e724f33999bfcc5b235a27c3188d25eb1eddbae2c802e41a123202a8f62bff7aafdf5cc08526a7a474346c10a1d4cfac43104d86560ebcfc0c45f45273db33a036e06b7e4c7019178fa0af2dd603f844b48e26b484f7a21c0a4a46fb6aaf363a66b0de3225c4744b9615b5110d1d78e5fac015404d4d3dab64131bcdfed6f668c004e4048b7b0f9806ebb0f621a01b2d2a28a6e5ee09b7366a8ae7ecdbc564dddaf74d9d7e69ec07c6c49d7e01f631987229557c0b3ebb52983a711ce15bc7b6c96138e9c1000b0c11143094f9a8d20b88121607e59d73a34d0e5c7030237c615bab2e7fc629d9141ecc045925da94033933cf7936da883271ea20af8896ccbef83b35d6fb51cc31c18bc45e5898e5198c5e238daebbbb1a7fab8824223b94740ed0f1408ae7950d62db3984180d816592e006b099c4240aa8e6f525b430bbffb9676bc56647cc8c8fab2a47df738504426c3f2eecb8afe607fa0c31b2d83e77b7f0b0e567f23d5f6999b51c194fdf89452216959130b5571773a26ff22a472998ab23da2e763e446cd8488e792a8168cb9ade5cedd527045e54cd1d7466f374ce06d2834685bc2fd3498b138b61109b7717bb2a384ddb11196854829a1459feb69967f8eac2143df27e0ec61fd55eb2a057d9dd2191069bc4cee9288e47d2d5bde3ea0116fdf698df8e971b15e88a2eaa2068801bf010360779711d1549eb410b622141786ac36efac69161045b8cc897586eaa37d025a245b89983d88a8e528b9b3a7eac664f1bc9aff03f83450679a314af5d254818410ee24cf0f7106a24f5a016bfee62010256039405ded489a1caad70944d2a6980e5324290ff070d50abd9193726f35cf179e4853bb58773ef2556354df9c7f2e169784b118a7c58d4a44abf80be612ac358aef85a07697d04da0176e86fb7602e5b88e1ad3f7b074757be4c3c679060ba9780f302e8a52601c52edff715b3f3b9bdff18b9a210050081c4052bb2e319c2cb4c73c609cb6a96d01c3e3023bd94fedd954b35f71fdca50877d549840ec736b2e60f4e4bd39b621836dbe758f78d33c176a071b276ae06f02ad74b0f18b31e0385ba1951a0baf3a05510df3f791d0b029c5abb18408d7dfa3514d5e0b82a125953971e842f1e802f9fff6bbdacfa609e0fbcce6533a824647b4008aa0aeb741674753e538d1682f6d2817d6ddb89d3b860458198c66d9179bfd5104bee7b40425b05e9aff9a0e63b59d5913861f5036aa4192630a109ad10eae1c12042021c1092e97a18793bf7c3f9b7487c4030f444c8a766a4123b34270bdb2faef178262e169f496a1729e91b3da3e9ff98682b5ba2d6528a56e54eabea172b4e14aa7b1bb5c038d96cafa8f562b44c35064b15a013ca0b1e52d5142267a5e4851ff8ee874ed618e5d1fb26649f3996566c11092d385fbd4d81a63fec05d7f8daee459fb093022ba861ef789d94e84d357cbf123851bbcfcbe1f4ec0ccd1e607db653b3d32a92997593327792653bca35fdac72a3f6e5d17d33d91764f2e2db02d3dda7ec1f38cc441b76f6acde02e6ff92fd8c79ca9c6504baf225104da15bbabc2708eb103e478e6b53fa1a4580676b3e42ce958f687e1d1a00ff9ee0ebce9085a90251b22f5285ccac19480fc51c6dd1776884d1aea2dc4bccdcd3c0f828f2ca42b2b5715ef430b3b838b402b836239dd1f7ea6cc3847c66dfc6a05163a20b9235f3d6aeebfda887889a4a198a9db3d34124c6d491c26f5c2af59829f02bff52be25c796a49286320f65237162f1173b8f2df1c93f63f2dcb3fc1a3f017bda3fa87514d476605a497813fd31b2d77222124e72cf49c26b6f18dfa44504f1a50b3fde00f39a5c0fa0a31dd6dbccab4d521ea50e4159e9fe5ba05b3ad0de2d33ab21a174b7f65f9558bcfc88fd7616a026d310fe7c0147ee7c2d63238fbee13afdb49b4dad240807bedb760ac6b034edf82f9e6bacc072c5422eaa511538d657e78a93bf3466938a844c7e157cfcdc4efef170b4ee85801e527200e210f95bddbaaeaccca726181f580ede536ec9fe03ede5fdb7eacb2c952361e1fca7a65ca397e2308f4f0dfce9453fc7b6ea136a03d2f819a7d92855c0c5d50686a74f658a21ac922018b123b8bc4cc3fb049b7eedc5a8cc264e9f6c8744b3c46c1d7eaccbd98882a60c9581269646171940605cd328eccd9a06842d7ab1bf64ed78033c4ee06cede9f4080f1f224c2ef514c45194ea4887814fdbcdfa508c5190e4cdfcfc2489a0c2f9c125ea6fb83f827d04c1204c48497eaf3fb418b92ae0097489d2e8c9a0b6cdc8fdd314208418393b0ced4870372c7e5d48259a4962f7eb7736ee8fdcc00344cd39aacf3de5ef8260cc95c49b76af09c515edfd9b679de447e8bbf4e65753cb3c44f7fa4560a92c39c1fb9fd45828ab579745052227cb212ec7f6a1e7f68b3e46c2fae74308e4497182cc3d51e3d5173ac46fc8d59e89a35fafa673b4c53d814cf1889918bcfa369edaa041a6e6560f572000837025b0a8f4265b8a4d709d144f94799a0d674b3f1dbd4c7d278e73a05f4ba783a70b8868cddf0c1211800076293f291074f58c9017fe332d12d638d89ae05f4556b5277398c7583b5d42d6fed8b29c939688328c63e4cad96b266b6ca8c7f6fcd260fbc3708067285c9a7cee4c8b3b06ddd818fe0bf47375e1daf2ca3712d5ff7b5d8706fe67bb07cba18cef57667d23c453f8acba4e63f348a6c67f20819f106d8f5544ccbacd82679e2c0610a8501ce106750ff110c97f618d29a51f835acc629ec95bf7c1991879e4a96ba0580e4971d3ebd054193967ff640bd4b944340419841e35d4a0422cfb7b359abf63cdea85b0b1254e9e447ae865a161e61245322d6acf199b9ba11754bff70489001ebe0b2718157f1ea8d649691aef97f8e42c1959647c6755581bd6134043850966e119049d4dfeeb13ec20f62b503131550a2d5dcfd3a7b281f6c3603ce63b41fce16109d5385620491a2623f6b0662d139bc09998b4941984baa4ea731fd759fd148d59621d152171827b59e29e51ec34cafef38b35a8c7c096619064efb329d1cdebad955f7e74f5efd275c3e17cb1f861166867e4ee030247697fbdf14dc167f1ec3b23e910ea0973310ffe7e4f347f663220f68b9f233a80ee6ab8600c357fff3d32c4097b2adc07fca14604d82fa73f6907141c1116556375a89daf4253734023c2487de1396902bf4f2e1ef539193b3b2eb5c4edd7835195e0cda258952d2634ed238dc02d905e5222613e0c11bccb03283f5a3ad724d62de0a580efd1768a7bb8a88386219a1ca39d1593e565f3bfa268e632f42ee04ebd7787b48d8c75812d63dd3c9e0e7c22d4d9438de24abfeeac09064ff65d287658cddf8f728fd316f0538666c8904b57ef16625bc81342821213d5077667566c56103608e66e52ecba884dbed6331f62a0a79f745d3119b4d70c03eeb6245b8f727ca8b045e62f9f016f53fa84baf4fd9c378f949db63760ee42c3a21f214746c74e5f3a37f24a0e1ca3c1f596daa49bb4928ba6edecf0481f4d6c15dbca01790414b27d09d678c709bb45b741d4c80ca411fff975eccb12eef6700e18f8a67bff3c7694e8f9e52165b256545816ba93acd9dc06a4a5e7b0ec032d0da569d6e377d9fe9a7fd995ad33727e71ae7ad72402d1e5b77a2c82f0233cafd1c2e0b8ff89438318a39e0f3ed523931bd11084111c782870d89d3910187fa3a4c7792803a24aa2db7923306cbde134536a1ea2b580e99277c0e915d6276bdf40eab5e241929867ce6b1f35124854ff34219a48abf21a8b8bc52b9d0cb7d852057a4ea50a04e3eb99f3d4e7a470113a8a6405fca742991fafd62eb70fe699a5865a446fbd9e4b6d536a11a400ccebe10a3ca071778b6c6fb734c87b22b5fca6f5959705f6c8333f16aa14adeb9e4292d6c9d18ebbc579b817c9a1c9564b0b51ea3569555bb89eca12e8fddd2a689eaabca26e59b68d9263ec7a92d9d0659171ad5868317f9d8eee525e50b4443adaabe102f381145826e95c9199739c836e27329bd83c822221d7394833c13a1d85625aa0c1a68582ab17db2ffb3e6075cceaee7b07f178189e9246413ff37de78c4a49d42022b03d158a5e881e4b7a62b76b78dd16f9138e74ed5c0b7ceb7715803fc6c6746e237334c8d6a3515daeadfc6fa96ba599d0ada9e2ba6bd0e613cc0d4d76d9a4cfced7e91dd19ef13291d4577e6925bb7818cfc8d0452076d75f0cd3528b7fd02b8048f6e23f310bec786dd3c7cc1520ca07fe98bde51fbf62995c09a54bc364a782f5bfad926c01da6e85e9e3a56651fb9ed2cb9b33437cf0c06771762ecfb7d893c1b31d52a097a6de329a1f45b710db873cf99107134f26dbaba8f25c5077b7ab01d2d29d09ada4ef80edf0669878c2942c1e35615eaa1638969efd01fb6b01ee069a7eb940a85e09168ff16601f14f8954f40053d3055d58bc547442c4f22182e9afc80dd5cfda93686899cdc38451b40964c21a2d2526fad28719721dfc0274c9e895423df693830f766af780094f247fd246550a07715aa8daff8a8dedf082775fb0a0859980a89b33cec88a0488354404adafa599892d0e92d3f9b20df4ed5ca2e103668aec004488bffb9a2a5bb50bd1c17fe7e2510de9e94eed3c41501324dc1f571505db0afa6785a62ef6ed95944be4d3ef5f70f0976eb0af9cfe2154b8e498459a2091e5b8a78c6dda6d02359e25365aae550328b963cf1ff5d79cb8ba994107b356bd8cf68ad636d9d4ee59d4263923d57b077f53adf71a0fad9740b388713058445e90499611f0aeaab7c5aaf3f5bb399b0606c0ef6d89b21af3a669f731b636bb3b891e726ccb710f3b19b5bedd690167626b5b4af4e5de9ef61adcef7ca299143325987493882d2dfe10986c87cfaba7a7e03ec3ca00ea058dc951224c76a5de4ea7509e062c89469cb74bc4e9827d230a8ffe87a14a880fcf4a9b28feb63f3224ddc547a6af8d13dc6dc7e7bab1487ab9dae500e9145657334fd6875922b86897ca2bbcb9279956f5e391b86e1c3498fb01178ba19cd0826a09463339e1591331b55a483c75b2ee29442e9c11d3c03f52a7fa85d28b4e037f84b03c42156e2a7274f77571d4d341148de80278468cc82f46b2e59b2d0a9e146a19d54917303464e21728073cd9a1c3d7201b775fe38df9169c3226a4aab765fd8710b38ff409a1788fb9dae413eae4c102f7d9cbf180681dc95aaaa456a959e8c6ea060cb4372187fa3d3cdf14442605d7dd2b408b8ba21e7e4aaf57b0b0161a80b1811430780579e74c97f075087c65464b87646cbb050bdf6b5f69e0e8ee125bedd67d1c996e0a9c18d1461faaa0b67c11a78713a64571d9c0318ef0d9f23b01970781d3a7b1aaa6f54ba6da9020d063ef51f13c46eae9f42bafc717972181bc4517bd35f05894af8e513980fcfea73ebf40ac102681a45dbd8af27dcaf41800329736586b3a1bb80b078287ecaab0dd37050802db3ba0a936a7eb1f77dd1af40e72e5cc41ac6a76d2f82b8ee0952bfdc4d665bd08dd649a8b9f2398e50a3829d44bf1bcaaa7e2d35a47582d1b753e4db778f2510a7205bd5ffb33e82057591e0d362cb01f765fadf4b2f8e725fa9157220d2056088c8d69c402f68e72aeafa109e4ea54a986fb96359accf5a533f9d0129e7419b4bb0c90adbdea82a5ad46d92992aef7711a36823c531b78fc7266e197f5d64ac62c7b740e03d2a09761a89b51549c212a5315602715b66f66152646066cad8504afac952facb0bd1b47369b80cb7cdc113087cb7e398d54a3e5549d3b3a8d1ba8c900ba7a6632d359588713b478152cd256f3f1342b5923bb861e22685ec818dd2cebbb434db0955b0fc2ea439911bf6a43587cc4fbfd14d85f92f8c14e6fada2b0bf4604152e8fa5d434f33fbe3f7f4a7a0e51105ea0f76b49f20d8e8c068d8419e86207b59263db94e4cdce38e868a5d684cda6585c312a270dc2727a25d415609aa7d13bcca51877df31f875bed7c7262001fe991f07a45eaef79bf3d227308d5bc4c399552a49688f1a3445025288deeb14dc4030c7868a7d4514a041382f0586dad4106685ea7060e03aea7954b36e1a79820ca91ea19a165757bf085d48c67891ca034b57849a23a7ef749d007fd526a8b13811210712a6a8c290db60b7817f6fef88e27ca5e2a592b6f3add3062c07d9683a545d032f0d7b2078cfabb7c50beb42c2e8dbe850987ffd4158877e2613bc60b2ef9850039ca0f56a7ca08e020565c05c69c84d76ec754c381019f2252c68854e2b90590a9000d02c84b64c3e973cf19225a646e26b33e63eae166307a5c9c5e217b29aec8cea3a7e84b39f74d06200a9de12f7915dfe90cdcfa29c6d741a48559638560e6cb82ce3a867cfbb724b72a8cb0ffcb096a2fba28ceac9cb667e3c82e9cda6522a25f6ce23fc6970d635074be8975ac1a4b5754345d6bad95288bc713998d4a4529a3f7e62fbdefbd161a1175654db245468a5e98c0fd3217bc71ed05fe5d3c30e154785440b7f49febfd4748f424cba688b74118d4a33202d9405765d85bfde8523a8f85c2578fcb3927f0a9e24c3a4d0d90e816be54a399b32df248f3246cf204197acdddafc5f324e5bb6207c18a46687fe9f95d13ccd1e4f29d437d2fd7007d542a85e193bec4613b3763c96068af7812f2da657e5b6b03aca4a77a9a09e3cca5caf78e39f42606bffe8ec578a2155cdb07c1238da1f138a878718394fb0e8bc105c80895831882a755b648b079b52f1f922b06d62016cea93fd4c5731abc4cad9efdd8986f9c416d5be0086c7552da71f1abca80f8236e80f0bf9b3309d8899c8d50e47e935792f534ac4cdb89b04929f3bc11a526b44f3ae02f4579f72dfabbdf183ef120224acb35597e44e37bec2299f477be60b0c6a86b46039f06f3899f03c0dd0c1553027a4f23c465c37050f5263a2d6d7e4dd6e180830cdde2b23b64d30a75b04cb184902750ba0e3e96f71a65809d5b5cffcb8ba65d1ba395a4fb227cd6b2d3c628bd1a44f5ad56fe2e7b20cd6809f5630ffb257e027c07f4a5964022a08a9efa512ee8a79fc1108499f06d2196eae98b944e386bef0c3a67f86d2a1085b22fdc2c201dc6b5ff53e8a039f2145fd26497563520cfc5bb1b30519a3e564d295b745bc4a897ed9c3025b9240101c8069927e15e9d1b2ef7cca6fc3e23a898fb8c42137f855b497cdb4b7f626edba8cb82b7986da31c0d2d4e3059d7fac644c0b4ccde1524ad30f060671df3030b5868314cf353900810a598af4e3a84112bfdb9f83d9bbac1be811dec695c5b8b113822ecfce288663d858b83c1272c8d2ba3116e82f4cf1b635a06c19dba86a2302a181dd7c99098f95f7fa299679c893f78368aa4e4ec5055e91f070321d20af9e5b19c07fd270d812c133a212d44a0be1223889e86bff17bbe496def0c351c2ddbf818335d11466708d77e5e421f0c5c039defedc4248f373f0810a30ce835a4510871e311752d3cd3ef952ef55eccfbac8db9c7abcbdeb73bb0787ab6220350cb1c34b4300cbdbc78c728bd60aa6248b3e24174633652850c18e77b9261632ac5dbd106446dcdf5079dcc4b3f39e334e5f9792537881389ed4664480d6f5bf4688e37ba0768105a7fe869fc6c0e32b70668270674b2bed118722330c045c573facccd93102f94c00ba70eeba517d543d2b91dfc443455eb1b92ceda0e4d7b5ba390563d8aca1826dc745a96986263cd7ea27b6ecdbed114019cb7e8ae80f47b430683d61f5530f5709736979dde4b61d807d68dd7d8e899bb2b345b9c5e1ea6fee9b2ded9232ddcf194053d3f2e6258796fca075774e79e92ae9f85fba576958b9b327a0dafe284246776d5a6ed07a394c020b3f166c0fd2193c7228a308c0e034cb183fbce7f5e9ff4beadafa4649371d843af3438efc0644c0f248db648a06d7f52024f88fde67c51d68c137956a8105a44f7d138c08362f0ea0c794955c7272eb9a7d5f6987067d41c53051cde7579a60d80c6d20f7f1fe0ab2fc2ed29aa96626afe52d32b050bef49ee48b7f29c1323db892d82518d653057de0e57ee01648149399aab0abb644ca7f74931c2be3614160bf2a87db4f12d341fdb6f41d0cb6056f655a0917a4486c61395c51e40d49f787dc84f1cd0b28b4802ec81d97424f5b78c5c86417d2e6388e7e84bfeddcee09e88bf873a6e88d3d1df9e79bc45334c52804c880ec97701db4653049a562587d4915ee1c41d39b1767be689d236d95a7fb6b1e9fb633f4566bcd907d3d457e2f4e3bc15d31028395d5d98b8de60b6074da22c51c7a5b47dab381d93305375f3f0c01af5e432662dac1c1357cbe7206b87976bfc0af72c4300a23beb6ed0f179eed769bc6f629514f145e1d3b3bee2709d5f752fd5fefeaca9ac6a5d1c72087b9fa4a8c9c99b978b392156791841a1817ec0bbed3405cd3829abdf99d74f73a61877c31ed26bd83142bbca5257e31a8124592f58480acb63075b2b3a69b4f080e3dc0010e44b4ca028ad9b2f822ff46aea943e5f1edf38497bdeff2cd31251b817c8b1f1d0f22d744fe3142f631145a8cf93edb0b47c40475649014861948bfd385141b36cd27131ba4b42c023de7162187470a6d17f840bae3cbf407c58d0b257bd29378fd405804bb79131f14fa492ca14e74c1cd023f0b7d0f05b0e96a84003a4bb86cd158561888532ad1bbe847cbfbcd061b0b73c864306a97402acc61e35d01257d714ca012c47155756c41515f984820de846c9e772d97957871bb811030a81b52b26b649957f34e59fb995a0246ef37efd3647db6ea726d49a07daa6f9f27b0c7228461fac02020c831c9e1c74458290408529234dada1bc170e3a1a761c8832a7e8e809a7cddd3d27e746fffd2d1d00faa2ca84ad8ec086af70ce4432a7568df1af71deb44e787b2b46b77b02ac0d989c067ce78ba25dc27840df1458604238d69f4be3973e64fd74d79fa8ef8578cb38b98dee805025b942f77f91858336d46673485744821bd4e8fbca26f7be154b49b6c8430d7967c637cc44cf47593e96384d1f785d03fecd1a22df695283e15b5245ce50e32f17f8f1b2073f91afc3f6d33f462aff75a3bdffaa512724ba388fa7b0207f1003dff6941ed04ceb9fc56318919504164c8cce659cd44a3ee25c84bdb59563672f276af595cc785a3a601cf7f726d0c1eb7a5d2296daeca45b4a733cce771a80b5301fac52420e15bbcbaa2783c14f6d6232858ea825934aeee16c6a965631e3928563b00754b0cb8ec91fd8cc303f27bc5c1a835bb0cb3547de7fce6788ea6a92d462479eef0bae96a629d5400394891b66b1911a924d1d8fed56f26d5fb21efa9f2043e0ef91fb5f3bf02b8254b5c49b4093990411e354a73f96893c0a579dd555b5957d4621625aebee1397fda23d58fb34e35e1e208aa4a79e8926fef55dc409857be9aef09f64a8b42e40783f6b5a4083f7115f4345c593a5ea3657bf4b27402fab69668708fba23fb9890fe7095cb9c15fee55eeaf5f7fda10569a1f77e5e7cf460c106e07d96e6174504b224b62ffee0c9f0e11ba6d0e91bceb7fe1651a9683b0e05d3cd90d23957a524af0af62b983ae3f25714e9eb6b037b8bfd11cc3c6f2b4cdedb74bc3121ee289e6b74d728631ae8acd6af950fb526373d1b34d32ac76650b8209e4a7bb4eb691657454cca4209867c928f11ffe96f6e550dd30443fb34308fe0316f5623db25db5cfc70e1e71bec2beebcd15decf6f7334779266a3c38d8fd3f900a3ed9eab231daa7c84f97ea3f133bc86761ee1ae3178c84f85423286a177ccaebf0e992c5b364002d4ba276032720c8ffd7cc6d8dd1f1f5007dd607b9de351e13486944c6692ee26e44dcb68eabe4c3fb96aa36812841703eb79250be5cac8395c72ed9a32d12628ca2afb6e274548d8e8861c17237fd7137a199d8ae97d504072f4c61a39952ef55f7c1461b9127e4733aa448a8c0c2612302cf7a7140d1afabef294a73bbba23cf7397f2f4bed393b83f7daa6a42ff193487cd10de5b83726154f609f4cf069a19cb48446df80000cbe2ba032fdfa9cebf9c6f70fbe6c58d1e6cb732bd2000fe96855a829484c25c4c1dd3aa137693d51361a4e41d47005b6d35ccbec6f574ab3ae4f263d87b0f0b26007b2ffd3b6f60e304eed09cbc2aeb95f8e90ae6db55ffbcabe2aa0309d158a6417a40388178e9cdda2aee8530dc14ec20ac9f16fcb1f6a38cfe96504537394f74ea2b37aaa402909a4d93732638ae1c2304c1e80c598d95ae837ee4e6a50e3c0321dd34fba6374b54192d95bb84e8772d5de1ff6a9119102eb6b6ffd079ea9f9864d56e2164f594744c7344d429c3778df8c4c600fbac1df9b931a59f9e1522e74ce8f49a4b5c9dc02130a8b3c87c62bd1d6094671eab4902cadb04d34d307301eedcd534929b8ffdf5d1e5a2779fae27e2ffd915dc28899427872824e32c111fcc04e9c4a61b98aba0458cb0c4c2d95cad495c953dfc9844ac74fd78959d25697d16f40107d79a4e9e33551130d5ed3ac7c516a746ccec8b98adec41cb080e27b4c2444a560081a412c4f5a5e79a258a89061d101442ef39c747a0c9f6b9d9290f35067b38a08f569ee6087777284e9e12adff297fb9607a02e87a46e18ae5944458e5a70982ea04dc7da08d96ae227dac586e6e075f07852e0d52713676e81bf230aa80f378fa995f76aaa170126ec23469a5b89d36fe26317972849b656ad6b1419bf2e2ac5a5aad338e926f1db4a6d310f7f0bf79c8228c23e3919af2dba7052d041ceeeb269bacd89e9df18c9710f5dad6c46bfdb7354d86ac0a669196b6e5a95c2a83db9d42e7c016d590afed71f2f96421bd70aa32030fc3faf0fb87886b91bcc27c42e15ab5c5e7c5993674bae83205937ef2c1209ef869746b03a2fe2b285527e4e34f2bad59bd444391022ba1414c6427eaa13fd29d13b86001699079b35ebcef641368e4af9374971db0f393380bfe0df7b765c57563f936b8fe893609258bfda3dedfd2b3a5bf25a77df19c346cc0704e6daa47c7caa09f252fb58b54ce965a7903794e4523d7904f52931c5eeef1ff8a58a22c17ebaf2f24e4fda13389e7565aeae8d28160dea8510e8c1b58dd838cc13f8d99da87ec2a453acb41dd9235b41419f84798fd386e3778cf9fb38408d3a465d51c333a298c44f08be12813579c1c3305fdea3aa73e953067daa0f0f0a3edd8f07480eadcda6d9448db57d63fe6f7e8de8b92eee5a4e2d13cf3f67b5543676fbf051b66b4726eb468fe77c28b720128d8a0ece21553a341676325baf94dfba8ed9c93b690cda561be956538b8300a679b60d1236bf7db4e0e94ba9bedeb8eebf4f7c7a25668372f8e364b6222b0dcaca935124d823eb2cb83a5bbec2a6a579c7b0bb792355006b70ef0b69732238e6e86bb9905b8e606c9953a392b23edc474c8dfcbaf8bcb27c291a634a2d1c7a95f6bfacb8f3d8ba54bedc71fdffc255b22a182d6584689cee8b8fc31a09daccc46640a1fc3f56eb07ab4435b54f8ae9e40ea5981452dd955c2ffc7c633eb40fc4edda6139f2ffced0accc32255e19ad602d4f54536d89d43763d9bd4e4c030a49663481fce6b482dc04d90b521eb1892fcdc85cf801e085c701e467d5bbfc6589918d7c788dadf68635360f8ab3325cd6edafe7d5f951a41d24f49b0bdef50395c025f1297d003e78c2631a09a0ca19ecab79abbdea6f56c79c2cd85aef54d3cfd3492540ddcb5afc17765d355daae2050088edd9ca8f0f47be801600c14b7fd7b5df27f13281c39f269d77ba59d01fae73afebe5ae2a4eb5e5de2b928b774e5ddc8648208407ac4d645efdb42d557067885e4aa2dd2e0566e0720264d51f7715332334a5e564221a782d4c884d5db9b46334f726d7585db69923ac7c74043b33f976c1a8c02214a3519b7033de345924063a1c205379984cdcfc526766206b2c34bfcfd210e9786749df7e5f98df5934707348e66c79bcbe869760fe64224d14eac64f77e78bcbfd4658e1659b0d5c619ecead5c4a69075ede41d7b7e3cabe207f5810fa23436fc3bb4b91becaefc72a9a59a1b057cb9e89b6663120ccb78fb7bd86c9b5ff94f086a52451be094b8c1b92a7b74eccda40f90567b55c242fe7cd0f2e8467ff358fbad38533dbf4cc047eb14fa8cd0dd3e56adceb8f7da011646e316e33d6f85df6e6440cb562f7927a7121bee09ceb29cd01993a10869d7a97b5eef638785d9dab344d7df423bcd4556f91e9f23268ddd09429be7db370b8cb9bcef2df7f3c458f9000a694e3b09782962841bb57fcbb78a822253b6e79e590ce2652fcbda5ec45130a6c1b205daab994abe306b6cbe2f1693e6b844c911e588ee4a2945e7b45f3e8f64e1a5027c2984afbd87d7e5ba07bc9648fc4dc5380842250dbdfdb4c0f4bb9ae0ca79d7ee52ec8499acf04ee4a074fd35391d0175f2f2eb2628ba5d6c67720c79a2d6da0bf621081c7c216f679a7c1db9b45236f390ae5f958c5d03e875c6bf7800661e0ac6553827504be34bd45349974e1f09e9fd62ea508576a52865513c7ec9e9bb34c735cd6f270bb99edd95ad86a70ec23a69b73a753d1edde9592e6c6bfdd1414c70f9c6320850c357ebca448cfd12d0433f85d3e2aab0a9617cc5d0d7d25453ae56e5268c91e668ff6cc325f58310f0cc124e2f7ac9eadaf96950a387463f02bb956fb44d637404d636d3ba60557da0f173750ab6574b61d9f161044845d6a03b7e7ace67e391fe3aa51a1b8db0c261b190ce429cd9ccd154d2ec890321f030de5bcec1ff45932fae551ee9b9ed499837173cf6e2bec0feb46f62f26eb011f54abc377d3bd0264c8375f42e2eebdab328e69ffe6f8d68a8f096250a3abd0c9bbad5985990b547e5b1929a9e82deb4d3eadb6ad4acb32c42fbfe877bdd787e47be177d31ec11f86c63b2ba01c9bb52be9502a085c45e0f6d505f1219a0a0497f2cab0fc88c94be84237adf245a151368565829bb62748f2643504dd85e0758616569cab1977f34c0ce4e88dc695142d0b6dd51adf5d04f6c7d99396977f0ad7e9192f380db1035ac8cfd9965090bf6547ea1fbef23be880b09ef7055ddcd9d23ab25a521b438ed1affce5976e5f3413a7d192e0fbe932b55d87f720e10c1ce721e66ba2c84e759ed759ccf5f1edceccf1559e39e3d46f0348329021d54650b537d44c0f091b571a024d59b95a546b0553266f5bcc65f82ab182fdc420788e8c604818875e9af04881fdba744286659b11c6843fac3f2e9b59c85825691fc88198a638434ef74b4e3ff225717e93828eee8e6d7302036da2ff8d9c75c42f3c405ec0e64d2eb6edb2d97355317ff2494211bc3e516624ea7f29ca6a39033d528455bf2e2dd2ec391be539d64f4ca778a524020f26218be74e22d92609fe7c7fa00e814c62a6107dcaa84e9281db0f8399fce8b3c8d1d7f044c2928d5d93fc681968b3165be003513366dadf2d7db27d3652e7cbcb145f34573f02628dccc85a916abf69d61c6c9d0792221f456a75ac99c61ed8147c81a0a86b7e7a36d41fdd8835a3370249b1ccbd482802a668ed44ce3949080fbf2265be1519f7a0cfa84d89ae44ba18e006d62f470ed5e0979590d9a4a6d7098b584872cd22f39708f146e56f556741fbda4758aa795b0c6df004b9c4db72fce6eb258d778e2ee5d48e404ed454a270a02baacf47bf67179e4cf1434e9096ec1a495889d8e88dfa17f8ca9b8e1ccdced281ea97bb0709074522ee772b5cffff4ad3143e8f981de178e7eb45e6e9370529a3a2109f6adf80f93bc7eb3030f3d9b02b818cade0325e78ff4a3e851a53b02c49476d95d9d14f457f00cc61cf6041d5c1c845f7d55295797f9986b065a832be5a6b4e7a03bd9370d32f9fac0db3e8a9620f4c0a0388c4bd2924a45479b7be45a71615526f11b3dc460fc8def8c90c6aa60eb1054e5d11182f8f66213205dc9b82d1cb358fe06172f990aa5cd2340e6ee73a6a086d6630563de7cb1353e1ad6aba5e631022091deef3446568b4d0cd5ee7a2697cdcb4eef0abdcddee00a699789248b6d65b89b7d150618e4d0298ca051241f6da49f43179178b2ae33be1f192167a1b7840b55079e6d9d72ddccc9133876c3e65c2ec8247511616418f5b7f816bc3b77bb5a11241803310374586e3e0a4b1d8eb00b21f900ecf4e62f9d3b9d625b99e4a774d9fe256f074c5b1ef76697acd976ad1ef89280e7965357fd562b61cb193fab23335ec8783304784fe629a1eb5349973b4c1406f684654cca875000b8a940386b13c201ea168baad00cd8eb3bf83dc1a38481d47d8de99fd3bb7b450f9e97c27c7e8affc70dac1172cb7cc2c68bb56383816da9ecede176410fbbc386120e495c563dae6a8798927c06f0f845cbbea7ed48d86b6e9cdc4b0067569d69c7d405a4b62b14e9a3f06ee78dd02ed007cb8ea07976659f00de506d91c8efb0f907b0345c80308e9b432766246299a8085e8203bb93df9a048f70ceaf7a135769f9e79f2c3b06ce17073c4e125d79ddeab32e855b6c9faa2efeb30d905a0998c803a015b0477d9eb04be11b465dc9df7712abe8d73b75a70c194b6b0d211e21be433159c057954ec352ab1a253b037956ed9f7b9cdb8a6dddfe52bb979c2ed49939bf089ff6a33d3427c8941320f200fc105eb053fed5d23c7c2b58f1770e087152e43bc1356a4e8a954dc2ce9f30737ba482822316c28c03dbe4bfc922df48fbcf4d98a5f7757feaf9107750941162186c9268b64e3a0d3affcd4a6a88266e0025b16f0015108a363edd89613628b89db28b1a857dd3ff8ff54c1db38f712e66cd5033d918834be476ee394d51648e1326c0b1fbfabe4483f9a56bddab706bca48cd824e78ddacf4def5095a71d7753026999c6f63ac67dd86aef574a9abba71e6ffe85f4b2d3bdbb34fe6f898b0d5d80784b04c6bc6cbde8f2bcd603e85543d6e4926eec317c89b9dd6ad11db5be4b23c074272840f5640ff01dc7183923a91e5bba6495d78692b69bcf6a4464b516fe5fda901569ee303d5e09bfd9ae556b85b44ca112657f47b65776ab7d9366555de4f5379738ae27bb2b8671782302fe9c4467278861e8980482e87eb5bd76bfd6a8f7821ac234aa94a46845705ebcb672c38fb8028a89b97b2d388de4a07d57ff20d83e77659f83a973800e9c9a4e371be0d9680fe95f31eff629ed054347b60ae1f90c9f9dc7b0feb17a9efa0d652432ede63737c8f036ee2164fbb2b72526b2afec75164dccd57ce75b0eb9dd293563e651f5763d5f6ad42a934a196ed1f90784a13ea646320f049e4c3424719efb3c368d7970f4308f5869da8575e0ad78f3d8fa68c980e7af6551e8af34a54082a86d356e848526e64917be3169c40bebc7398cb7b6bb010ff15938b945b60d6863fb97910dcd9c24cfca4b3204defeda10eb89f7a7510514214e69cee81610e01f87c5c496b05b45f5b06140108350ad5b2242408253e438f456af3d956083306fdf8fdcdba108d8449bd30e2cb41986f9c132652ebcfbf0f0480a5c8637b44d145b14766144c1b4d9099037cc67e09daaa1761c7f140b8df2f2fc93bb4a25e3c662e1b6cc6d55f132afb603cc5751011ca3c6b176c2d74d8ae3d66b8de26dfd05c7f8e036162629b5eea62c0d93ba16e323b53b125526e596d4829997f8d9bdce966df99ca2d5c59f273bf38123077b9530ec85957c80b8a01658db861f631c14dc128105f63149ea92f6722e54d6a5346e8a6d2df00352ad281c18f23878d320aa34f96baf53520d401e17ac5e69be6d1a6b2f4a27970dceb65db6807cae2cb18d93dc9ceb986d008c823976358fe8067f294af6c6f54954f74a3777a6514534f3da940020d9c15f1ea122ba73010f256bd15953705edd5113be2b829c58700f2c6666773c1dff7b307e92ceb715ca35ec4f1556217ab5262ba0aaf5d154cc0aac2c678b586cda93d16ed0ebe3dbc562a4af3eff4c3b62968646806648c73f19c4368bde79fe7def0340233ee1b53e502162d2535ecf7be341aade25be8e89fcd6c5e5b495f717687aabd4b37ea387dfae7b815e5d81c6d9f6cc2bca3063db1a631e4347b988739e779e5f67582b56cab2e6a16bb869b4d0ae6e860574700fc508886f58f648960bfc37520a2380e09a87b2abca83189891e79bc20b8f6645d689293dc397d1678507750397a90a6942f8aecfb7b716d3b92b1c1edf20bbbf8a1a1b7ab2e8659cbcf4bcb188aad72c65c1224bb655b7338ee5977c6288853c9a9647515e24c400e857ef36f978666e4d6660e50bd802555e1f574026c55cf870be1a24e54aa57aafe9fd89aa41259044d608e8b3ae17b3fbe645645c3a7d4d54a95facbdd9a3da4633e9b680fabc8f84229ba7280e2f2770bb6fca9002a0abe4c387c5c7165cd48eb5a99e76c2bf364f241b81f3c2818e42cd7f4acd475d7ccccec86b820dffdef08105e00394a2d4626f7457fd5c29c215f1da41f89a72d45d24304231997393545a38ddcdeba1627e563f51a2b01f2dcf7913995e053e66824152bef1e07993754afe17d86c4c5c645af926d53693dc967ceb86a0799f11c1003b546a0b1bbf70a390bd5d3b021f2a3c6d2920da0fa413fcc324937b2b3c7d6cecf04a0857e96cf5e33efee70c842153acb9397adfd6d1b9314e50ecf87f9567cb5b524e8170eeeff181e021367504d23fd411b0d76c9985a159b885795b2eebceb6cee77fbaad3b4d6f791eb1151be903cac1a81c8c90ffa0e1b324b88ea9be5de9207ee24b88a33bf1c6c0e969424ff726a6a612644f67f80113338369c7f6c7d3d2c72aebd28f21610273c9400ffb867e52b2a2f0c2ba683b7ae6b913d67d1620cb9dd9e16832b9195cbbf6b48cd47c93d0acee20447d06668ccc1d45a38da745060d263857030f3f9ac9257c402d7e389f5f99d2f47a41c08501fe8dd44ddd076e39a8ec77a6178afe3ddeb6b00d34432f0f1e96e1b61f6797988d391bda20ef7e821f172feaece08fa798c027f0ce103b28ffc192a473e0ca06b76d1feb62e4421d73cb625d6d33723a2b1f853c10af71b8582d23aa96e01a766f0ac3837c1347b0b548e4b4a717ab91f61601952a1aecead33925c5e2c8c43bdc331dce2ecdbade42ea1c3280656290fae595ea32c108baedaa50ddfe890b648371a5291bc1cad8c56353bfb08d63335358604e2b5033a7818a409a37bf70e7a89dba9511ee5f0a5732b199b0f555749c172a9625f880ed45f9b9f492ead427fca4801518491cdf4141e3ec32eae35ae7d9011e2e02494baa1858687d32f92b73be326e386a8d54d106c1dbe2f341b1ba1dc66b8004e273a76c7359beb377cefda9285c01eb80e3d5454c059f0531beb6f01407f9eeab1e40fef282a0d33e6d9a985e53c3caf84b1c1c10fbee4f119ba0d0a5fbd40a1d8467b6561f61fa46e7bb1481ae26efc3c2d79b39b72709b25f6facd25e439ec38f471593f2391beffb7f9f692c3df30b88230c9a3b9fb373b75630a004e71e24778996f3394f80c81d4b56e37ff9e659fe5786650cab0dd501c4d8afe5a8f738bab8e385ab7c98066c5013933004c51caaec0155f7c75215e0a8a5bc4e4c33f4337f182a7041686b7b0fcb19961315c6fd0473ffe73f130664dd5743c74d81f3f2d97cbb847bf1de940cfbe605503de33e14159145fda6b4b3e03d9e5df5432e8ad14b2d2335ca7f85d64a79591c0d03ddc45d6eccdae627ac9a31a0f61e7df18b07bb9d4905d8a34c7d4a750bb38cc52d87082f611793fd5e870b08d1693d3cda27a2ed3e00062a764223ba3afb12ab97ba24a5d0262283fe6db5b82d15b795be8855e93528d1b097a7d4eede6d602fc144a5c1774cc72db6d8e16d7b2846328d66630284f9731698b4a888c249f299656440bdfc676ac1300d8aa658d41a74aab29564c0ea4b94eb9d817b4e6a5056367333a99443e670b6da7a36996e23c3846f863d1968099c3ea1411033ff54283c72c1c0b75e2cc69c22b19a7be7eae624134f35802f058f18f3d28f57e0a9d322b9edb289de8b01a8b4ac3458899ccc6b71d3cc1f5754d91e8f9298421ba7d1a0f71f9b01f44f76653120c391e354c4ae292e091d09f64bf88728e08d0a2981391114f64283e0e4913d398af01dbffa2fa1b7ccc88333fcff1c75f079568d9831c9d794037a509045babdf548a801a8e0e47429fd3fd5b8279c46e3867509e7c4ea4e41289f7fab03e8e2ed2907cc00310917904b06ff63bbec163858db081c5308a747f548f2ef3169a97e5fc87cc085303d61dd35e51a9f05de3d1f1b260b05eb146cf011f5e775176ebd9df559a32d9ecf7410e4e19fa6653f49701e03145b8da1fed5beb012f63ba517d8f689df3e36b88b2bf118a9a295686125746c351aa2c760a0571771f0939ade8a41c2af0030f60d0b75ce41c9cc0de1d444c2bf22541911caab7dce5f30ee4cf744ae7007bc567a1bdcb998fc54a4f6295b41fbc59423d23880db3d1cc4bb75e64bd52b5b29da97218876eeff6e47e0e196b28d1201edce25079c8930ee371d4645326793c62a00263cb2687ea2844856a30963516d5ec4b89fca862a9540b0db35d60c44de59a68e8ed006a80ed3e06046482b90bd2d3e76a34718ab6c2a9ab9c2a3237cb97b3113b48907e8467fb16f7e2cb8f1bfff7aedb0de7b5fb679bac3d82d31f35e093cffc19a9798f045ee21263d40e71c0340eba61213b94b7d3375d4e149ebe92cce21d9fad3607055133ac79c5e786ee373126eb1e5b06fcd5c84d7c8c1abb026aa99e3d4e4c7fd429a44a49beb5234e49963efef0d4d096f9c32969de8d5fca373664cabc49b08fcebd8e426801d5e50431b20666580c51703dac5126c419a653c428f7248941894b6022b20feec912126c3d23c4629561438d00073c6c40554ddec1784fc48e17d592a0f6ab4e5065a59d16c7bae3613cd8be18c25743e8fee58cfda797919ec6727928389be17365bd5381a8413b3b8a75e092d18371de7b1a6ef7a265d4e6efc35cfd95748b981e507bc893a5f7ff2c6e8485a34b0d239649381d51f87931e5a2576f03fa53c923de919b86faf98b0463fcf44a7eb4f81d44a4382f68640159c49e8d8be706f0d1a350aa0245f3b1d5366ba89dc0e2a120d3ed64e0eb651a7a88e48feefb939349653730b89aa86d70fd3d07bdbc0f32dea43594f42f75157ed7f796e781a7f8fd4049e5ff5bb8d535d1bede8eff690a497d4c5fde29a48221cbfb2e2d9da9d2dec511218b4ec03948de687bf89a6e914a819743f6447a349b163cd4a4d180595e006603d396f826ace32326f8e1b598d550d8621f7ebbab5bb52074da8cf7a972863f599d4de0718ff71ddcfe811725459627cf6245d2f4d923e0730eaa5fc95971d8b5ad33c8b0d3d33d3131a5d7615d272914c31425bba65d7e1a959eb0f8900da49782059d8deead0d8c18508d0066a3c46e8f50c01b50539d0a5e20c33049f9acc65b207e71d1fac4cd766cbfc15add923004531adb7bab1b55b20792dd7974f57455f6f6fd899a21f3e5970132c5b4c1443d7f5b1d59d914edb31ec59af7e7c968ed9a8c84f23bfb306a88c64e41979a92cc98ea7404d8b9716199921c57fe47ee560aa028955f1e497f44c39b540bf7f041843ceefe9fae1ac3e2f1e66192363f29ffc0494783449358c2e76a6017c43f70d5e4174ff1eef52b662331e1ac286a88173f9407b742813560d3b0c5e880cf87f4d11c9f5d74051a8e731756858839e00f33bc034f42ec6c28fa801ced933dcbc6d2974114a227c942a6810b106c2e0697fdf32dd0d00315653fcd1cb3df7b99a91adba75680971d577f1e743224162d890cd5e913d9b7e591084a6e632d16fa9b3a200fced370dc5cd7cb32d5eba89ce1963a671391f2f68ef5b7131be3cd1f2e08c6c9ee400baaceec1dd87df522c9bd7bfa8864ae57e48087f5871f98a9533c014abd599c900dbecf42af15aa273c6393cb1be5ddaf04eb080e966080659394af331c6967eef8f74cc00a03178c9da2f811b04041730fee08365389f4b3ac2216130ce5da52878f11b7716e7dce8088ea90ba7e1eff7b7dacb394ce43017a4c99c424e8e94340dc6107917dc0423b303c5c1201f57666642c69ea80e03d94294792c20fb43040d7bf52ff267dcfb00695b3b7297ea8519207ce97c04e3b20227a1d0d5eb673c541b919110cfb3b45a252e17fe191cca3778bdfd17ed8508064df8ccfa22cacf11e2fe834e043feab00211738bdf3b2a10254d2106e2d0c00a6fb258c7161c2e2cc2bfa1866d8a5ba7be62d9d7b7882c24f80d9e0c9b6d84c910ad2e7c8d38f47129cf072b522b2230cb2899b2e4ab2c245572a2067d9d6967405f1019b49429924880440eb4dff731a2ea08e3ef137dc032e77102d626bdbcd1a1b4f7a19b72ee0dd1ce33a04d8eca4c98f33fdd422cb82418c9fc65d67a2e643e36e7fd0ef6437baa01172e56df62ed5b5971368a41b673296cd2d5674c3e20c630a2deed93d16502ce50b00f9eff78fa64f05a4db32f7da198dd9aaf747873ed1ea54f6e1ac6ef996e4bf31aebde5786b260709adb7710fc96c0021d093148250a4e8eb67e0e7e247175b2c50f46c4349b085b6324b96b942ecd3ecb6536ab47edf5585eb0dccf48cfaa3c29cf408c428f88bb119b480adbbe603cae3bb42fc5e95dcf394823ce2d109979f4c99713fcba45cde3a768524e19524a9c948b2037403dd2f0f9972b1e2e0182aa85b75f94c5f037233979e06005b3ff474354f2546cc959ad1736e398d49c9a69ca76af9992e4d4f768a9d43ef1ce89cf9d9b3d90631f0a8663a09eb0ef651510d652ee17a11b87e739ef0f3267d9689e58db3663829712a90812c5207283e16b252b1fda96fbb1f8e01017d31674fb79329b570da68aabda38dec9da3532562a9ffcf8f852270363d79d2ccd0023d4167740e898416d52e6915b1f2294f32101675645ddc4521070b2e01afb6380255d99579c2d26996c3d4e4ff6f6031903cc4c22beb68fcff901c9831d8ed0867944a5080eef9622a1ad9e3459e76379618d527a6662b73a240e44cef8ca2ec16a314f4b921bb325d9b755a37afc04a9c6547ae89c696592850d9877712ee940becf441cfe5d0eb9c575bd16d333e74821160ad1d7a3a4b42f282beb7fd1ad999e0e0a6bc6b5ca6f69202a5f0f2afde1844cdb64cc6803758dab0a62cff3c191c70c38162837a9814ae9927141becc8313dd30c983000ee18ae11a8b0cc48a5b22b587c544e06e2ed5fa4c25d4c9f7672bbb4f07728ba55647c6e1ce9b43c69a711af3390164fddcb3fae87aba2e84342477e1e7f21201a0fe8e2c687dce97c547733f6774387487b1f98a37ac127b9ffb33886af60a2d6dccceabd46b839dbc7855d56356cad13469762773bdca1f628efa1aa35ecbb426016478410f028ed4ecc7f6d7df6df181dc03ba162a0e30bd7af4f2b7f6ec42917d0184593318559c09038d1f8b552c46f626866ea0f4818ae9d4a015d171732b2c96797990dc77ad6d0559af0317e50b956b3edb22b9cb1cebe538f68a17fda0cea85794fd4a5dc5d709084c6b22022f8448de3680b92271b4eec860ef3e75a3e249ffde11a8c52d8412206292df4a4b888a47e0c14348577d8c631046cc2e83d9cd62ebf9fedd33ffce0f3567b8170c55a4aafbedf5059d3472ec22aaecd15b77593893beb9f30ec73a40ee5db3c04663e1cd35e17ec604afef4c4be1a267dfbe88b62fbb6557996bbc056d53275109f75afe0fde6c099fb73b7c42ef074da55fed667b89cf52df335000000000000000000000000000000000000000000000000000000000000071b";

        address deployedPrec;
        assembly {
            deployedPrec := create(
                callvalue(),
                add(precomputationsInitCode, 0x20),
                mload(precomputationsInitCode)
            )
        }

        // Initialize proxy
        WebAuthnAccount proxy = WebAuthnAccount(
            payable(
                new ERC1967Proxy{salt: bytes32(uint256(1))}(
                    address(accountImpl),
                    abi.encodeCall(
                        WebAuthnAccount.initialize,
                        (
                            pubKey,
                            "SyGaYLTddRj5criwRjw8OBNvzg2EewdPIvDBE5fIUwM",
                            deployedPrec
                        )
                    )
                )
            )
        );

        // Authenticator data and client data JSON (in hex representation) retrieved from the webauthn signature
        bytes
            memory authenticatorDataBase64DecodedHex = hex"64c582611bb7947a158dde1d22111cfbb073a46f933d7c8dc36c5debee6a18f00500000000";
        bytes
            memory clientDataBase64DecodedHex = hex"7b2274797065223a22776562617574686e2e637265617465222c226368616c6c656e6765223a224d54497a4e445532222c226f726967696e223a2268747470733a2f2f776562617574686e2e6775696465222c2263726f73734f726967696e223a66616c73652c226f746865725f6b6579735f63616e5f62655f61646465645f68657265223a22646f206e6f7420636f6d7061726520636c69656e74446174614a534f4e20616761696e737420612074656d706c6174652e205365652068747470733a2f2f676f6f2e676c2f796162506578227d";

        uint32 offset = 39; // (78 / 2)

        bytes memory callData = abi.encode(
            authenticatorDataBase64DecodedHex,
            clientDataBase64DecodedHex,
            offset
        );

        vm.startPrank(address(0));

        uint256 res = proxy.validateUserOp(
            UserOperation({
                sender: address(1),
                initCode: "",
                nonce: 1,
                callData: callData,
                callGasLimit: 1,
                verificationGasLimit: 1,
                preVerificationGas: 1,
                maxFeePerGas: 1,
                maxPriorityFeePerGas: 1,
                paymasterAndData: "",
                signature: signature
            }),
            "",
            1
        );

        assertEq(res, 0);
    }
}
