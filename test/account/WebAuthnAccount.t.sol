// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;

import "forge-std/Test.sol";
import "openzeppelin-contracts/contracts/proxy/ERC1967/ERC1967Proxy.sol";
import "openzeppelin-contracts/contracts/utils/Strings.sol";

import "../../src/account/WebAuthnAccount.sol";
import "../../src/static/Structs.sol";
import "../../src/static/Base64URL.sol";

contract WebAuthnAccountTest is Test {
    IEntryPoint public entryPoint;
    WebAuthnAccount public accountImpl;

    function setUp() public {
        entryPoint = IEntryPoint(address(0));
        accountImpl = new WebAuthnAccount(entryPoint);
    }

    function testValidateSignatureForAccount_ValidSignature() public {

        bytes memory signature = abi.encode(
            P256Signature({
                R: 0x72d8ec1eeafa79ba2c2449de57384efc8e3d896484caf9c0ebcd0bc11cedcaee,
                S: 0xc9e9f49cb9f7741e49a7afa443205b5950aeaab6993918f7e4637dc653817ffb
            })
        );

        DevicePublicKey memory pubKey = DevicePublicKey({
            x: 0x13b4f84ebcf69efd1b530db4d3e76c1ad8136023c8442c9b137728b8af7b7a27,
            y: 0x64911159afef4594b66a1f4c92327bf1dd9600dbf32a4052b5c643fea67ae566
        });

        // Deploy Precomputations for public key - retrieved from the server for the given public key coordinates

        bytes
            memory precomputationsInitCode = hex"608060405234801561001057600080fd5b5060405161477a38038061477a83398101604081905261002f91610037565b600055610050565b60006020828403121561004957600080fd5b5051919050565b61471b8061005f6000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c8063b5cedec81461003b578063f050fc4e14610063575b600080fd5b61004e61004936600461067c565b61007a565b60405190151581526020015b60405180910390f35b61006c60005481565b60405190815260200161005a565b60006100898383600054610090565b9392505050565b6000823515806100af57506000805160206106c6833981519152833510155b806100bc57506020830135155b806100d957506000805160206106c6833981519152602084013510155b156100e657506000610089565b60006100f56020850135610157565b905060006101276000805160206106c68339815191528388096000805160206106c683398151915284883509866101d0565b90506000805160206106c683398151915285356000805160206106c6833981519152038208159695505050505050565b600061016161065e565b60208152602080820152602060408201528260608201527fffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc63254f60808201526000805160206106c683398151915260a082015260208160c08360006005600019f16101c957600080fd5b5192915050565b6000806101db61065e565b61010091505b80516000036102765760018203915060c0820386901c6001166080830387901c6001166002026040840388901c6001166004028489901c60011660080260c0860389901c600116601002608087038a901c600116602002604088038b901c600116604002888c901c600116608002010101010101016040028160006006811061026c5761026c6106af565b60200201526101e1565b6040848251018239805192506020810151600180935060fe5b60bf8111156105e257600160601b63ffffffff60c01b031983600209600160601b63ffffffff60c01b0319818209600160601b63ffffffff60c01b0319818909600160601b63ffffffff60c01b03198284099250600160601b63ffffffff60c01b031980600160601b63ffffffff60c01b03198a8c08600160601b63ffffffff60c01b03198b600160601b63ffffffff60c01b0319038d0809600309600160601b63ffffffff60c01b03198685099550600160601b63ffffffff60c01b03198984099850600160601b63ffffffff60c01b031980836002600160601b0363ffffffff60c01b031909600160601b63ffffffff60c01b0319838409089950600160601b63ffffffff60c01b03198083600160601b63ffffffff60c01b0319038c0882099250600160601b63ffffffff60c01b031983600160601b63ffffffff60c01b031989870908965060018d861c1660091b60018d871c16600d1b01905060408503945060018d861c1660081b60018d871c16600c1b018101905060408503945060018d861c1660071b60018d871c16600b1b018101905060408503945060018d861c1660061b60018d871c16600a1b0181019050806104655786600160601b63ffffffff60c01b0319039650505050506105da565b60408b82018939600160601b63ffffffff60c01b031987600160601b63ffffffff60c01b03198860208c015109089150600160601b63ffffffff60c01b03198a600160601b63ffffffff60c01b031903600160601b63ffffffff60c01b03198b8b5109089250600160601b63ffffffff60c01b03198384099050600160601b63ffffffff60c01b03198382099350600160601b63ffffffff60c01b0319818a099250600160601b63ffffffff60c01b03198487099550600160601b63ffffffff60c01b0319818b09600160601b63ffffffff60c01b031980826002600160601b0363ffffffff60c01b031909600160601b63ffffffff60c01b031987600160601b63ffffffff60c01b031903600160601b63ffffffff60c01b031987880908089150600160601b63ffffffff60c01b031980868a09600160601b63ffffffff60c01b031985600160601b63ffffffff60c01b031986600160601b63ffffffff60c01b03190386080908919a5092985095505050505b60bf0161028f565b50505081606082015260208152602080820152602060408201526002600160601b0363ffffffff60c01b03196080820152600160601b63ffffffff60c01b031960a082015260208160c08360006005600019f161063e57600080fd5b80519150600160601b63ffffffff60c01b03198284099695505050505050565b6040518060c001604052806006906020820280368337509192915050565b6000806060838503121561068f57600080fd5b82359150836060840111156106a357600080fd5b50926020919091019150565b634e487b7160e01b600052603260045260246000fdfeffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551a26469706673582212204cd43249ad93606c935ad4e5fae69d4cb359a8563ac399831710cafed075d7f264736f6c6343000814003300000000000000000000000000000000000000000000000000000000000000009a8295d6f225e4f07313e2e1440ab76e26d4c6ed2d1eb4cbaa84827c8b7caa8d6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c2964fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f50fa822bc2811aaa58492592e326e25de29493baaad651f7e90e75cb48e14db63bff44ae8f5dba80d6f4ad4bcb3df188b34b1a65050fe82f5e41124545f462ee7300a4bbc89d6726fb257c0de95e02789e96c98fd0d35f1fa93391ce2097992af72aac7e0d09b46447f1ddb25ff1e3c6f5bb1eeada9d806a5aa54a291c08127a0447d739beedb5e67fb982fd588c6766efc35ff7dc297eac357c84fc9d789bd852d4825ab834131eee12e9d953a4aaff73d349b95a7fae5000c7e33c972e25b32ef9519328a9c72ffddc6068bb91dfc60ef7fbd2b1a0a11b713949c932a1d367f611e9fc37dbb2c9bc1ee9807022c219c23183b0895ca1740196035a77376d8a8550663797b51f5d87dea6482e11238bf2936df5ec6c9bc36cae2b1920b57f4bc157164848aecb8510afa40018d9d50e59fb3d576dbdefbe144ffe216348a964ceb5d7745b21141eaa2e8f483f43e43917ccd84e70d715f26e48ecafffc5cde01eafd72ebdbecc17b0990e6a158006cee85f22cfe2844b645cac917e2731a3479a6d39677a78492762736ff8344315fc596439591a3c6b94a6cf20ffb313728be674f84749b0b881666b8babd2d27ecdf824a920c2284059bf2bab833c357f5f44e769e7672c9ddad31855f7db8c7fedb74e02f080203a56b2df48c04677c8a3e42b99082de8306631ec0057206947281fb9ae16f3b9122a5a4c36165b824bbb078878ef61c6ce04d7fdc1ca008a1c478d1f89e799c0ce1316ef95150dda868b9b6cb3f5d7b72c321de53142c12309def6ace570ebde08d4f9c62b9121fe0d9760c88bc4d716b1287595c5220812ffcae5b82dd5bd54fb4967f991ed2c31a3573dd5ddea3f3901dc618d1b5b39c04e6aa7c8181f4df2564f33a57bf635f48aca868f344af6b317466efe0a423083e49f343a0a28c42ba792fe96a79fb3e72ad0c31b9c405f8540a20604ed93c24d67ff3668bfc2271f5c626cdfe17db3fb24d4a4052bf4b6f461db9663c62c3edbad7a00d1a10144ec39c28d36b4789a2582e7ffecf4d5190b0fc61862be6bd71d70cc8e724f33999bfcc5b235a27c3188d25eb1eddbae2c802e41a123202a8f62bff7aafdf5cc08526a7a474346c10a1d4cfac43104d86560ebcfc0c45f45273db33a036e06b7e4c7019178fa0af2dd603f844b48e26b484f7a21c0a4a46fb6aaf363a66b0de3225c4744b9615b5110d1d78e5fac015404d4d3dab64131bcdfed6f668c004e4048b7b0f9806ebb0f621a01b2d13b4f84ebcf69efd1b530db4d3e76c1ad8136023c8442c9b137728b8af7b7a2764911159afef4594b66a1f4c92327bf1dd9600dbf32a4052b5c643fea67ae566c0609a4328130abaec8c2af807664bff4a3ca97fd579b5fdfba02962362ee9cdcf9cad9eae162d23da331f5c6375af798af4c637840c1698e1611792ef8ce347a9a7e7314cd20f4a43aefc920d737686e5b6ac94ec00618b4d63056a83ae1e42208e779e8be44266e9f73483dab2f1e485905a6dc012eb5ad7b9fd4cccc80eb908722da5ea859a47b3d3ec5f84ba1a16cf17b5d77e3ba0a8b267ac47eae81c72888fe54206eaca641f2e203b69eaa4cb3d08970c4fb24bfe4b7a777fcbe560bf8efde26993e4bc77baebd545f823f1595ef615744e5602095c8e0924b30c790a943e27091fcdd75911ac6fcc45f1c55d0dddb180904427ea1859d2a816332df1b985a6e6d26149114020c72e3228e9d6587e2c92081bdd83b1106db9fe2cac83e24400195974a648aaae388b440bcbbcc923030667cc13432c54d3386ca3d12af5dd666e40f4fcc9a0f26e3592dfb588a8c025f6fbaa96f7cf062245d07675d439f7979f52d841292b84e6a6546969ad6812be5ce6fc71128c4dd7eccdefa19be637872f9547955a5e74d8e4136b62f91438eaf70370226cd55589a6e28a8db57b049f1c7c4b6911645d5c89f264de7ac5d7b1a5355082c55b59c6a7ff159f9bb586676f5a51e5a30de9769e5bd84be306629bced904d04870a88f8cd098427163481b282c6903a07afe77b37cd4596a7ce18fda3f8e5053f76bb68441b3012da41718338b9d9a24fa4c7f0969272046fe2c8a9d3d45572d722a203a6a35bf61e242cea1baf06e56ff3f5a96530836553efe5c5c437f6ac0a4994a321cc8f60cafb20ae5ce4238b3e240d2ee459fea606373e324766bf41fe3a22ef689c83c960b6058635dc72489eadd4f75b3de56ed212effa8bbf77088bfec574875ab6396b6501026c7ed3bd74a151222b4ccab3de4363c0fd001f0d39e7ebb438bc46488ecc4f78848798cf80244d8e4b6c13db44e5c9ea19c3ea890e1fa98581b8c250fce5a3e3a142be44f6e70d11fbccc68b27a93f5a96bec4e1138f7602be28c50a7d00eb657ff4fb71201e269dec44a140869a7ac6cac2b7f223d3893774dfd7d6506849066841b567522171bc3d3115a54de77de28d8d8ed666de7495d653825777982fd5ef2a258ec1241bcdfc129f58547f8c58b6fac6de42f11f1aa890b83aa2778d5b96a6475adb45f40e2e02b32312102e7884d3be039d2ceb71a84f2ba176c8f18c2638e53f61146f72a716ca76b7bc1b0d8baa6bc619966a39132ff2c96cd844174383212b18e10e8d7b6fe02bb84e4710abac28507e268fa9664a90c08d9d2a635f02db585650df0bf3a6c2efd58d206a25f1f3b3e24df7d5b1af49217f1fb6c06cf6a276409ffbdc2cca146d37954ce9f24424b1019303680e91d7a7426e4f3c1f5b91430d921f03364368d378a3e72a45d9076ae6928d728af845c20e29fc777fee03b3b8299473748fce588a4ef99c3c2c9e80a790798df9960cc82bc2035e22c68fa56639b8f8d771c1c490bb1d4e32d93b6c7cd9e25f4d41e9d63e2008ce7ad905ab289d50f5884d57b671a7cbc1e2a3b288551b4792e3c3e25228b3e3719d51b58d1b50536647d4215bf38840edb8e2c559a62b9e60407a8bd2b20ee96dc57dedaa79742e40c2087de4cbd1a62c9db313447ead7463190179a0a5f9fccf3d4d8f0e75d2c8588618f39a07fa40afc783ed112fa9cff7f8462d3a1546983fe316b10201b4445ec9aee5dc56bc4727a089e4ffc98bc8d773c86d21ac41e52ddd0b778ffee3b38ffd2e998e3bf6e48991a37f2ce2cc7ff5d4623dc272ef3d91fabe797c9199d3bb261026b38a131bbf03c4439f5160522cc6c0f93d52ff61051ba07fee36f97ce6cefbccd368012adfb64cc60cd7eb3ca5acff131ca3692677c4d88243f74cb18ce73632972748f45cc9f636ca39ae96b7d1d80dd3931b3d0ebd02ef949dfc73709aad26b7881b8995ee7dafb6ffabac36d86117ef24aaad934d4fb55b809ebcc07ea263290c32e392120811ac3c48518eab29abee09723b488648c545f7113998c78f79eb4345a42673524cd03cd38f707db9ea865e0ec15f4a3e2efeb8d7f08eec7a1c39dc42b2f36c080fe94454e0bdfa89f82605c1f8cf0cc42206ce6511ebb012009f8e5d9668df1daedff385f08f37fca7404a26ebfb79114a4e614f23c652d99a3ecf1981d8e0ab694d64a369fcb906bb8b9f83669b0a6b792555a0a484183d6fceb388ba99f140e1af0fcf4e1ccae8b6f69fc5664adce68690a53df95526b66ee36c5fa422f60632450016fbed35b9eb89da4ac45ce8de63f07eae9b626e1a4419de2fb03a3e308c1304c20d067da63db578db53f9a4db776e98a2f3c332477d182b751802b42f43074b30d72612e35faba10e28682c98385d864404c6875a811544956e893ca2486c8ab4b058e6cbdeabe92d7073d8a65b1823b8d710e2c72c8b267b43b618f328706f0a16eecf75f240e052d927da4fea02d6616278448ab30d8c1afa6a94dced34b8e2d6e105f0e3b9be66a4b39b477ee2a8e0a12326aa8ce51732a88758f7c556584ad49e6a5fdc0fde53f95a709a19ea580e5242ae80ba3514a3cf4d222c3bf42428640f6696eda8dd4778e64e4c1f949f23c24bbc4ad1ddd3af13d6845995bf646995cd8184879cc07407bad0f226e0e756933fc7f5c0b2ffc0c1d444b363a91b6c40c2c1da4b296274fb951d299f5ae7a4dcbb058045621e5635a644056a0b30d217c7bab83ac803e082f6937c87a68379c8157f3141706003f9e1dba7930c3605235ad41dc90524ea1a167b415031a87b728300081a6d6fa0b8e315b5d9979d4e711327b4177c524ea5a821ca4bd61284f795dde5bb29adfd27a38ede322d73b4dc62341266a4bac0f688e2c894718b35b2b9c1924a80aa31425d4ec6f97c3b8ca87200225c9a259315332456895f1dddf88ef2a613c517f7038b0d1fd684322fab592f5d19a05adadbbd92d781946e46f23c217071832fb9eb6943570a67a4859b022703001b3f628ce6990a00ba0977812a47dee8278ed8cf02e6df35f1347f8d36835ba71756010f5ff3338cd1d9f3fd0e53c3a360a744a8b7a9ada4a1bf866d5db78c82204bf14a2bde0e8ac0c30a7e45865232a2c88385e156b8b9b10f750c97b716a622efa1fb9f65d6f850d101e7043ea582bcec11be17ac41bc00e1ed1a4e70382b556f9439c40448a08b66b2fd4993262e1657e01850740498f741b8798998d5251d176c02c73059c046c99ba032933875835aaec05eda9d8abc917def6c70233d595c96f8d011103277e9582576a0c19d80a038ec59aafa938fc6a4f36f98befffda9c6b6caa26fa76e7f5956a783c69311c957069a02e067549391b4c3d8d4219c6019b122e9132c0b4188888536b7c23420f714dd55ae616ab2a9bffb44e985a2cb4d21fa6f3ef48ca736ae9692128bfad03202ac5efb52246d06785862f6030a8479cf047e8f0a985f8d68cd5139863b4674184948c9fcd400ea183987189a71ad526cfbcc2212010150aaf088d85f45d45894383684de628a68d9d5565344cdaa7c6bd14bb2bb583add5440b6eea50e6bea3567ec341c5e8f634fd7604ea70eedb112c83e3da9db413a4274ebdaa591e29fa6f0a05a44ca075d197cf81abad4f674bd41c1ed678fe4b0bd468447ed25d46fed6ba89a5546e70adcd578d83cbc71c447ee681b8a347922ce6192a92980095fe68de14d9df3cd087b6fe7e21f67fab7bc6e817498551d19ee98d8797f7bb890b671c96741248dd1fae3d28e0adf759695d9ece60ccc9d1621db1cf29e78720d69bbf535a2ae6eface08da9b0d3787f33d35a4f296c25fb9413e67ba5b978a19d5eb9cde382d7850d18a8de1f90c7b487e5014404e0697a737c0f7edfc28ac6435db8abdab00b9b2f2b8daa0fb7830ffb73b44b13926e71121f1dc3ed2189debd4343761e25b2a5fea0789f0c6e3c075051882d9e89dfec35fc87713c7271c79d9c0b88d4da9303f05e549bb4627669a52a67f982c4f8a26b56fce881adbcdcf512a6f444e14a3fb202f76889f5e267c9d771c88c88834975d7aa2638e000776aaacea111ad8de4dd4fa349eb5d1e5c2630c4610f84f5dde98375ddf036f4da261a50d14a50a86840ec45c8ca962f6785dd7cd96982200b1b2c677d2a7645ac9dc48a44db12e68133f18c424f53aee10fd12cf57437231cd4470f43af004afbc1bdf554acacc4edb20abf492970e197db6d560877adb6ff9ecac093c89c609da874abb073d793c6e9519c49e84de83e15c63ef96c431a070d64f25b3b6ee47774ac74fbf15cfa4a55781ce542efcdb5cd7b1cf0aa84494d142f7e46e2659be90dff7e87b13e75e86a4a356587b7fdb1f1c278b23e8b198b4807bccb00c3b5999edc8222dd2bf50cd2eecea3a4ee85345d95df4a1bd8879a292b92748b948d5074bd7b86129cc618714f127767b84095961bd79003adea197bdb8fd40db6056a7b43ecaa8e5b8cff7aa428e0ed7cf9fe42ab4bd798c67f7e09cb2f2a6414323565e6e8749e415a9974876f4c16b71a1eb705da1a38e0a3bbe0bbb68843a7a5444f3ef26399b26186b94f9cade16419b8aab8900210768fc6161566444b6cdc9bbf549349a9032594155f8fabc6b3c5dba514b4ec312abcc297d64cf788628ea59d2fe55f7b92693f7a7e232337cbde31284bf4020772139145447503d2c96fde32b9441907d0d79351a27b8b39639bb88eb186dbda6b658dbd280096a71356c48573b1c6d06108c7447be8fb60a96eb94d547bf34dafa6b0e9444e4f1f1eed341e9d864aaaa2acdfb10fd486d51b9bad2140f430db8c6d43f55d304111d9ad27b738f7c140e9cd9b5b2ee2ef7e1a314fd03e16de92970d277d34c6077917d3912d2061e706f853c978c9a4977e18e8c3d270d573e051070b149d6c6a7871d26223f99369ed2df462c18281022fb11b7cab22eebbd433c9bf2f3f240ed9f79cf3ec4c54a0549f73db2915388ccd1f6cc6a574c9c03b00a2f69a160b20c9ce52a11ad9d7282ad509ecefb192e9ee98e71a8619640568eb7b9423a92f87a29871f7905f3b6c532f36443ecd544f853bdc4a7a5d59b98758591c99cb86f41ba83a32f07deb3041e0e57e2911d2cfd37d9aa10ee740d787146b8b606ab7e578b2d15f9476280aeacd7c4fd5c596b9108aff894b8ca7a4197a53a99792d721efcc0ae8d0d06af91ce0099601421bbb7796e99701ac9524ed6b08d37778a3f351a0258f33d22493d3b9eb789b2045a17c115f3709e5414f460ef53caed75e45ecd03badda2608e0073930edd73e13e11a561781dd3cb4da19a27c72b15b0597da7d9147e71bab7f9dcf8150ddffc9a2b11dea911fd589c43620bbdadb2fc938311aae23658ce0029bb63878be692f8a1a508ab7b72d028d5df453c882d72705e925528db5e5477055da97835832ca01beb650a4a6ce675cad05d490af0eae7d059fb23bd8416cf50dbf57cea9e396330fbaf152c8d0cd098e0dd32a8b41d7da901879b6b4ff4244b9289ea1d42790a88581d206aea6d431c488d7f0a327642fdc2777a81836b0026dca44a050bbce7c84679cedcd443f51d57990545e5234a534b4f4755bfdc77b5fabcd0f3fc7f1c788bc13c5da5df2a1b3977655363a8689d11861ddfec9dfa4e8793a8e4de07e3355bac4be935014b2cff902347283495e7504530f62ac9f114f76ae02874e04a1747d7f70d5c6c1c407bf4b135423b559dab46a9f3547b0523212df4a358aa3468a1cbd417e0958a00a814c0d565673d2e30b4e48da17744770b61fbccefb5e321e83a7a37f1b3249e2688c64789e4f258bcf96618b36aea303a537320297ca60ce02a8a1795051249c5b2365cf8d1ae40a170e082adaa1fa881dc2598cdfb19cbf268098e8787c0e60afcf8c6df7998015984a3b0191cd1e7dff49c17ac94f36c78bc13de0e96fef316584b0eb322786251fdc7a34cd5b91ca308fc8ec883544110057cd65d3cc3a4cfa7b3758e9fa2c2e52c7e28afdb10bbe5e43fc409e3e4539bc8980f04e5a4357947df416c49e59c9a43d7b9de2536666ca455fecf75bb549698c7846ba96dcb817c2c137c08e66206205200e5089d6f06587f3b8c574c4a87c291016e902620672f17b2a9510413f638190af49e7ea022b8d3be3266b2a8f4f3998998624aa9d68dd10cf4bfe45db3f9de01dd7b737be03bbb261a4c56d265a15fd5e2e4364344097bbd5ed84a2c741e94992949e2db92da6e4efa459363e1a410d7e74bb25ac8bce6c8f614c46d4a8684658fee1300ab3c6a2833913c5e90c8d274dbedda2b3329e5b9729a45cc1e18814dc8bccf7f86bdbb4ce55d6946d7d94d412f4b17bf23746e0a03ee761b968713df93f9bec5075237060733eb3aa8fc2f195ca156adc7200d63113216cb42b5ab9865525c839f766bc820da8267750edc128616a9f3139924c647e54b52c9ce79c4f922571815979a17b3a1b34f544a0b8fdfe36296a19dddfa6391196eb27ee50e3bd38c5be24c9c4fba065e47c0dba1d73ac72626f20337b494b97b453209d9470ca9e441e31a0158e9a515e17a55f2e3101d806501bbeac9abb200b500765ab0992f04776fe683f2aa646b0d4d933be26a9763c016799dcc38dacecb633d15c7b891756ed650f4febfe36f376fbb06b0f0e9b016a0a5d0e7e1c1a661440f6b512e6fd1ad8f2a761034df24c9b8fe76dbb4fb1eb9b047877fd444beb95dd90b0996741d6723584ecbcc4b1c9293abbe1e0c003c18649030547847eb06329d991482e35f9b2ce0605cb3c7fcf9380d809bebc793310b6fd94efd61eec0c13e1f5dd91e1268f30d54e5c27ad51ce44a69e0f7b11e0a4de7f7829a061de752b201a28315f42def733cc8548a02da0e845460636b3e496e55e5f0ec5ba9425fc62db0a54585f7b1536b9442bf75eeacfa63779422e5a3e129fc46a93b7980b1d664fc3ca50501e0cd2ec8b3209b05fdb21d163795c21c57fef11d2b6a852aac119001a5f93918da8936e0f50606173287094b25afb8286a75b9bb24c85fe86c0a9ab228c642195130f6030610a3f0129f73017138268ec1eb62b7dbf1538aed771da0f3dd91e509068bb4d622e748b21e5be57036538d93e04c86a7e4f0b0f83884261b8a66250e3b80e03fc5ab6ef52172381dc54c873241146c39bf2ff1a4da45d0cdc8bfbbb5da5a5e57ab79fb3b515f9e8121f3c131bdfb99ec46ac3180af2eeea07880c386737947cada8c21d0080f79803ea44c1df71a7864229281215f10f716afb9affbafe833d37940301340e3fa9213742e4367568ea8a7adf68c06b3010f145d1c46a9034c077478450d0ece456af1cfd192a307f388e447a3f063eafbf4091a4443883bb7112dabc48a0bc0ee59bbf056fec849027fdfd10fab093643c271c436808f353f7bf5387cdf5f5ebc8ee18ee48615c87a5252a3bac7908cf254ed4869044a572c937a9390f62c086addfc82bddddcca23b20500726dfde78dc0e5a9593a7b1c6923b16fde6cc345b2c4d82f6aac30bf402b36ba6f72b2f20a6486d5d4bca41473604a070f680fef5c22fd30f18549274e217a26ac291bbf9cb4621ed018a778a06c79d8ccedee40ff5de35b4e488254395bc0fa8a66ba6c1e7138952ee7b5a9f4508e608bbcdc04f35a96d170dae6ebf3b46f200657653861f0c9091e40dda2b98a2bc469f54646d20d07eea2042b6ff62fbb83b6dbec6040625ff4c177cf7384e45558513e141e17fddf5caabd095db330ba1e0b8ae8a0304011140d32c65e59aed0babda0f9413f4a3a837dd995ce7caf13ffab160fc7494afd7845fa7f3552887e0f2020b26152a71c2449f89801da4db656c947494acf2a762638bdb0d9da5f53e633c6fb91518b206bcafd2402bf90775399c4e10b3953cc135d6230a69659b3c02318a04a9d241dc71772ef5a6bc14a6da202cb71bb196059b8668d04800d781f180e177d9a59dca39d9ae921d003f58a5f67cdb0b8cb04d19e1d8bed73af222335d0c8872003fbcf3bffd8752d1a88a40fc6c244d663c048b3f2e5aa12f645b4771822fec0a8d0973d103d393313b9404701079896d4132e6b8ac3ae90920983a6ba6026773f2a28850c76c43efa8d0f406b4370febc44dc97e9ff1064a328b51a46938f3d33157c807e0c051cbe4a6e577cdc6fd683d254125173218352d9fdc620fe5f8fea194b52ddd7f288bde4db150c3c467860be664465176876e583b709d67355b05d61a6d36e3303ef941369e088be25d863d1dd6b3dfa5a51c3f75445483e1ec134deaf08bdfd418a1de9429616864d69fb8b3d4c40e24887ee86ec9627537474ebe37252935cdfb9fb90973911886578a538bcceb7c774adbd5999b8b69808d5f6fa322b8c22197ea41e5e844cce7445b1a7af251067126032cd970ece128801a245412e55f8c1030ea4a005b91346a472616112467eb95dd730f68ff178bf884c531444f9ff2f7cac8ca219b35c462552d78ecb0d66aed4dd393126c44ee2a619038a669040b1ba169e607a91c2f5a485a27be7c799e55c4dc2e951c3584d9e77e07fdd18ca214000f35c944115dc64b46c23d3a8969420f171b817df8fd41e9ff748223a9b833a4a5b66eda79b68ed10f14fcf9e4da918153e683bec1f9d42782e6b915cce1518ca5d3d0db7f96900d84e76b5fadbd2bb45857a6d1fe59eac533df1bd0706d5aff30017fc7dafec2b2d541a601eecd16009e2ec18e6205daf729a6510c4744fb3e7d788b34a83ec2cb1396853d6efc142c5f5209e76579f1ab8b684177590eca2d9e83d1a07aeeb92b227dd17be6c92292649ba175f80514b65c3ba5c7a9841385b071b4aa8f23b5787c412c1c10c26bbd8c6d015c0b71be4c413e3f443c60593516d16b7deffa6ffaec5c87481055a37b76c42303cde31a4cfe864870612ebbbad2f2d4dd798ceba14dfd5233df03b6c0997a42987a43445df90dfd58e1a77f315085fda83da1654cbe12cbab802cc29e62bfbeb047801cbb6628614139b62626428c9034d59caee68878f13290ebc6786af50095a0c2d9ff4b6bdc9347fffd77f7c294595b5f8cee4d50b9aac9c4a7195ea0eb163c4ab7f330aa769d0ec27b2f0729f1b45515746929d476630fe0dcc8346dda1de439cb54ca2223fd0a8f5027c73119b41b13447cb9d83ef3caaf2b39712dd0db45636edf948083dff64f07157c3c95b8e9eb77c7101976db67244a84439cc704c2352c7598a27237a8e84aa5d58e31f7892529341a12b8754977627962fb2913663df1c8a3242c55eb0acf959812516c35921d50cf8d82526fb7edf56dca6f95f564fb2641c24d7e3b614e95725853e601c0ca5660929ba7647e5101e234c3896e8cc5619aa06a181ddbc06ebbfc52bf3aa7f51262d8d31b5f72dc7afa2409f0c83acaf6131cf5a54635ef6ae05e3a130fd6cf954e92becbf632f6c3e2c0a82491c88671e1464400ebb8059c658aa6244c41e66e5eb285f52cd85768098d8950d0c1f2060a854f406ce43a8be37750dbddb57447de0c78785391ce48a3abe9a55a9b6f159727d472d703640f70e69c9f229fa14a6515951f8fcdf5095e7883aaedde8ee7a80354966c4cb9760fc0d3b9b90bf8b710c4e7e6946e7c267b69f3463e906c1f3037b3bae037a574ea81f0885867bafc41596249f6c8ccaea5be998e9f2f51891bb3bc645d10ee794390233b99a2c8a91cbadb5684587a3b660946ac8f21de00fd4bfd494c65e015cf9b4a5eb3998e4dc0276cca004f42faabba987dcdd1fe29b1f4171e611b0ffe657bbbc8ba21a9beafb6cd7ad725a6da3ae4a70301d4358ed4895b9098e46d4db982fbec3bd7d3263e96dfc9629c238b3b8896295d1e328811575e75c7ed1ac4f8bbb1361ff582f7d0ee0db82600972c7ff826332b698daf6d16d91877ac4a7a717259bfc19867a0c292319d662143bfa45ca47f3fc87623ed3764b41188a8feb31e5a0c69ad6fcc9083425a34e7e65ecf5a043d933c405c86dcfe19060b33a910e9d5cdc46667513ab5a641383f279ce19bb1f2de00b802b739561a0a2ebda238edd7a85b8f59c05c93799e55d8aefee18e8f20caf64931e25bb48d6a5bba1439ff67676eeb422b9ad0e22e65b1e9647d01b8b3dd02ff4f00845c04cb4a81d792ea4a11d932aeab84f258aaed265163b91239c85fc42272a18401a1dc8639d9779c6d14394b1b18eb3587f50b66102b9736cedb5f7eb9e02586ee79b244363e314fbfe1fa06276915f6d60d578cdf2c632e7c07e49001f40bd97bf0eb04677d4a9f92aa439b33d638728be0f14d56e4f125949bfb73b6bbecd7b75ed30c42330a02bb6d4d3a42a83970019aaef85e904a03663636d06217f26aaa3be8848068e4a49f464d3686a3ca1a55ed1ed868df189dab1166e5ed935dc6d15c89369eedfad186860ee9ab45a577e24ad64efb70840bffa8580d4fc5d5650ecb0f44b3bc3e34d1995176192790ff8ae0924c443087d37c2420dbc3914b5b49ef388f662eb847027a7a8d107f72996bf832641930dcf0bd09086974ac8319815ec8099aefef0e852cb786f74ad94717ce98023eec3ea1846594ff9badf711311221e731c2323f3fb7dbcd97a584a257242219931d01b3a3a9c576806d51510dc4abb05040bd5406b8e4f8bf6229a3b0951bd2aa137b408243e2272463ca931c41859ca395ef1376c0408a0c715bb9b84c883285437c381f6e2ba88f6805f0303b462c1df4dfdf280164425020006750ec4fba4bb065937da0698b3890ff5606a5c30032ee583dd12f7249488d4822df4369490ebe97e67eb862c2cba862fb6ab89ed646c57422fe6e7d3f7b3c6dbbf9338434d2d7fc0e41d0c8faaf2a591373d78272327320d1cd2f356d7af7ac0cdbd6b667e0f0d0a7067e874f09b5dd397f630b2a1a253c94bdedd3fbec1940a28a918b99d7242bde15dce476c0305b2b63815d755fe10fcdf19986544d5a43aa1421223132228d1a19c147b4fc4d1cfde005f90ebf9a7e5ac87be79ec72c573bf4675e9fcb7d352797ddbb34f33f60864cc61bcb0147d625b77780c8db290d25e937956e7b32b5949a0cd7684a4019b81277a124a255f58ce462934012af51c3ec04f2051d73bd921130b6481bcaab0ba0f9964486498fdd7e4191a585f792b3aaca717b5136cf9a283123cc9b907f7e8b94cdb2b3d3730bbdca66a9d94db36a7d5e98e8a816e229a0b6ee267ae925d79f5b4bb25df6ec22c0e94681a88274a86c536b8329f3f26c110f8de803ec35993a22c6ed9b2eb2c48e1bff3997d8debd736cb8cb63d962530aed53a3f204da3f1aec5c699dfba03cbada87f4f209e8332be302b1f48483cc60a2d06957a9c8821eba1f29ac31e173ecb4a8346574cb247f6debb0ef689283332bbfae0b13b16107c613db735ae6383a8db005e551ae0627170ba65ada1c602a3528b48b0cc032c4f5f66831c289e98484e18d275b9697b8e2c7f72bf279be6e5ee762d275399a444a2ab283619e3d6904614bd552b54c9c200a3c28f1b65867659f96bcd988e8431fa5b07164d689b51be41567273907206a0fdfd6020b89ac0079f2184bd72ec91b7341530bd9f3e21c389b246b4fb5de4b0bb7a463bdc925475855821971f84e87409d17f90ab0d2132d0219ce8e4b6250668a2737c650ef4efbfc05da38525023452a034c7bb00c8207a5f078d8e2ce48653ff2f47d8f7aafad6951e531bfd226c3c7ffac7aca6a32b576573a5d63805af37171decb02743ca759effb18c71cfb956810c6bdc5740b9c4bc06f6367e0ce0019908dc82d9e3be818214147823120b3f3e8230ef10f67dbdeb8e9553d411ee696002c0f649c1dace23b22c10512ed43da1449a5a8a4d0832758742a475f9fb243ff36aedff63d76c618efc276ef799242243113d4b5735a90b15351701d291864196dd60f7c3f574a72002a6fb4a00419bd9d89ed9eeda6b7814aca20dae1ee7e197afb6dd3b0029e63c9a735e7ca1ad58d055643b3caade1bf7e968e459023a8a833cd7e7f13fab070d034da8e8c8fdaaaddbb6473c2d3cf896995eaa6770e29f78e2ca58a5c56a34d304d3acaa44a2e6fad32074a75393ece5a3f7df6724181595ca81925d0daf242b2a5af65d36974080a39c3bce47dffba27ed9dd1dee746a58cbc03454dacfda4e44faaa634c7b50c6549a3bb8c7f18d4b0647da9333d2d159a8080a7c383f5d372eba3ee2e4be55fdb572b4c2c3201524bf9610cfbb6685f6490a89d923a0919b9a3b52d4f5dd1ab1baf2816eb837b342bb38ea3102a91d22deb6cef58cf3ea17a71bc90c0404f4d83b5e8c675bf93bf9830b3b04228d9e8f71020b9f8441296046a42e229fb74d3fb551601f31fde90aa8cce0a080ec331f74dff69effc5c37ddf16e7d6f6b315e12b0873890bc20893a0374629cfd561df03a75484218ed6c8ee9d7c388827cb44c0697b78fa44f6ecea03661611a1eacff3d41fd47c38f3980c4e68448706edae1e6ec0009d739abe943766dc7f645a2f9f661492e44e0340667dcc8fba3678f71fa4ffe86006d5c4b0b4b2a8088408a8d2d9139d2e87b6302d1072b83a0498753df539bd5fe9cc5c95c824751d87257d85966a3d021ddcf43456d99c3d15097531c3a8ba4ed8dcea1f1411fc44ecca2a2b5cac9384bd83e7270dce7fcfd8ee88b1c138146fb5b02e88f445ae2be148a4602548d369a62201ba3bc73b141e9b0f3d9b02db8db99555bb4b6dfad5651efac350d5b82f894061a2fc3625c003f9ed7da2603bd59fcb90c9affc06e06746d2f7683138b224245d8737348c9516446750c2f36ae572e962eba5e252f6cbe2f0cc27b6664eae24c4c3a69a21f56e9dd3f1c6f566e6f9968be0b1caa6284c964bb925e529b76fc6ec75c3dc893002a6be6e12b01dce1f6a5d9f6ed5e9834d49773bb683676375ce48930b07e7c1b0af40a6ec63305a3cd87666723beabf7b9fb7d20317b926ecb5763cf244aace135c13f5a1dff7547e85227c68c12834772404c125b9d2e0fc070dd50a359ba3f77daed347d3e438e79e2e06ea8c59f1ab1bb01b29e5095b85fa6a4c67eb6e64ab46b6efb605427fb76e0937d33d1fe6124c3eaf158b58b780add8dbe0f1719c3c76c67205c6812bfba835148275fd985aa6bd8279f4a3228fb0955b8db1e809e98fb9779c384c04f14e3cd9293d98c146756d9b22fa721597fb09d4768cb9ec16a222174abafa963eecd946c3d31eed232f2f77d17b06c309ab6d6caec6dd365dc8c770848d51f4f38dfed0614666ee0bb713b10e51ecb11226e3a9b5fb993d8a36a5ce7a19f2a62b0fa959d4f6292c41e0c5d7ffd8e49a46b8965627359066e40df1369be79dff8cacfb3e114d241a18277a143a2685139c0c425066dc3b5ca2d12cb0e7bac18b07ebf378f66dad0d7be1fe5d4d03c62d59e8001e728ada6c3c196a3fd431408fa36983203230008748087fdab649d73b0c875115d7216eca071e8bc35cb8d78c03bfe199f4b795ecf397f9649b71a4e18d6ec816b353f1766211ce23ab0a79113c7136df512987269fe3b2ddf683d87e894bde2ffc92bfbe5660a2a715a948b2e3e73e2aba46c8ef1a80efa80caa23aaae7260cb8afe97f82efab2e99d7b964ca27c7bb9409b9a5cc1bb355c135adc52a3370fca1e94d10642eae89fbccf28d10ecb38fc6f4007aa169a73464488369fc3fcdf1f5bd3e1b853693ece615c585ef2d49333187b0150657a2512f4849565cd73cfec9974fbf8ec6bdd1e19d9555ab56e275f7f83adb7846c7988097ace33221ed6f74acd2f09c51da32f69ff19e79fce5717aeb06b9acc8dbfd585af680f6fa14149fa957966e3fc04b0a89440aefef17158dacfd26ab78c894d34991d3ff9cfe632d58a1762851c151912bc06eb36a3d9a3c32d6c9cbe57429a8dc1809fae4c6077f9bf799e168cf857ca5a145230bb637cb408b9b8c4003ee9a7fcb5c4da2537e208e0f97f688c5f2f4eae05f2fa772240bbb5279bf66bd0e909057b5ae49c2c565aea3fc9bae2d8b41a60014089543e4ac7a7b010fc00654aa1bcf7ee9581aa8f0b586e4272b5a04e9d63559d13e486ef74422cc3f71a299ebce5f60eeb623bc7be088464ecd2ef53f3b4c766ecbfdbae75a1a24e1b413a76ab7763c81c69779688607fb35ac8636672ed7229298ff889d29b34c1e6c484c48814241736382cb273aaedf2a6e5da0ca5519027e5b41514bf2befce73f9ad982d05f6fb5b91b80a657d681c7c77bb1201683ae99489730878eba30641354a0497f06fc81f89b4811a61d721cfb880402bf2977a9b2b0f422e40be0e9bc3be2336f112aeb6e3343709d1288bf0412a3647b82c8bf7fa160de3f76c54f0707df2a74ba9567d25006b5c7ed5a6b8b768bfb4a901466ccc60cd5267964ab2ee6e11c202e2faa18b7b2e13f40fc94b50e6b5fa009fef4114e95179f3c66e1f27ba2429d357ceb9c283cad3e23ebdc2858fbf452d01712c72aad91537afa6cded575d276dae7f11e2175afca07ab32419ef09a1fe5c3a81d2ac5a63cff6de6ca93957934a8d5c7c3c7ee12f7c26a39d7cfc7c4a8c3f38e316ad2d2f9caf548bd2d019320f1d34b1f61553d0f00e07ec19c8e58c7fe95569e76183ad1849e74175c147b145ecdbf27e33a9a4e300ee4a4ffbcf5f86bc0019d2d6d64741c68880e8e99d15c9f1acf935300a9e2852639e62394f1877ccaad11ec40e0345e0c7056f893fe7f5a792382f0c6cb913c4206be68653407b36ab56004549533f3b02b61958a7c7d5803cbb264e88d08996dff0944036bce75b2587639bcb8f5c6cde1c88fe8617960bf46ab76cb426f9391622361bcb161899f6706bc53159fdaf4d2fb96244cefc1c10e610fb0827052c949acff80440abd22327836b81c7a89f052532a5a0321bd44194614452aa243d1f2de10d17f97d094b378e64b72126295f9d44d178781fe8f424a06e60a927564b1a6c45146af2ec9a1454d0e3adfa740e1210da7b3ed9a4f1a29ed16615dd41162cd36cabb4558c87de453ad8bcc3a69df3ba1e1d27a16fa15d3e0819d23c25052fba271cab04ae1ca10d6a423823fd57198714ad75ef629b98eb43c284d77412810e8c056842d450b6769e2b166244c4534cf4e944551b339549b2ef3afd70edfcd6a84180d7dc7da9ccbf8ab787b92c536c2ad701b5392e889734ddca9ad7e75db7f76b919d158fc7f17d34f80fad8230f4ee9c3b57cb7646fcdf6d91a7ce1b278d7d5100ad7d5c246b74d07313b4ac93beddf4803581487ad1f39138c42bf7f1884cc487f16b19972ffad89dda937c48de9bc0fd1d15515cacb1184b5e4110b21a79a5faa78971b1463cee3da6bd9dee3b20c41376dad2879b5f2af9ccd8a541332c4d412e4b0d766e8763f62795fc42a966e058dbb1ea20d9b2cb6281929a3498c491a6300d72be596509d464a134a8a9388750514066f73d965b0bb2c12d868cb561066e2ae6cbb9a872e594a0ffe0a9b56a207bce8a19886c7c1d1d04b0efe5f563f790eeaf62d4791c1bfd00d83420399390e98debb463a8b3ca6fbf489894344cda7b97baf1daadd42aa6ffc50667c9a7ef3d68aaa477834395a4c7c80a9436a76309f9c954174712583e4e2911bc9bda31b1f444cd8908b46a11d87d89914a526f3caa2963210cc0e568ea9356739635a7a9be068f8fa2fecfa546ea4177d7bff9720310983a14f798e0b6cfa517dcd2464b6126f4d78b60fc8986925f959cd74a2304c98aab55c61abf938db33e844a10733d74f3d06dfaa9c56e2000cec7d19b2cc269059ca075c0fc0dbef432171423eba53dec7b5d36ce125390e0e51b29a80b62f3d9a3fa6206a47e7c6698507bdb59665f42c0f1dd464a3381e2925bd8acb20040b938865fc49f8fc8b4aa73aafa0f13eee2b8332d1c1c9265862548ecb2c615e4fa4d07dec8ce18987eaf2d12c1c1df98c4a4bc45331b4880eaf818b41a6c69ad325b75c3ce99fd2edf093e4ceb78a062315396acf25fb28c9b12bf4f0302943340113433e6c4a923fc221252b0a42f28274c2bb8c36b673fb54df6d99848ecb199eed7094c939ef957a7e1eee5456160995f68f7b2ab6c7e6825609c39463f925d6c0e4278b9009bf815825d819c76d0954fc6a9229212e5c263d8aff4f83c94e414641e4365893de932aec95c0b9f7fe9ff9128b232c54ce3a804842705d10c7dc9e082948d90938e4f9efc0980ed212e3ee989719af6569a27dea83d6256f90d78b6c8c54a345a1f78e4ff11b2966cfade22e90ef0deed65ed95b94c53682825e263322ddd1a20e8ac4f085e3ed1d1ecfaaa7d42efdb7844448127465abab21e5ed380a35f3ce720e48ad0dca923f96258ebaafcaed28830667865a786b29636844015b1a0e9deb22289616650afaa7ec7d9216ca68c603a1cad12ce3df1ea771130c579b16c4bd52847512e05d8db3366bb74f0c26d9ceb2300e8e8565d556f6a0978e671ec093206b25736ee71d68ee25917eaea926ef8e40255f6a75db713e34aac5f6b27a12b2c24189f91ec86190e701584458c5dcaffbee1beadcaf2772f4da3aa5e3292f352553026c5012eb572f9adc2da41030d2559f66fb0130a09c09ff9f629f43cd6ab79781ac8feb36ebae083226812925012afbdc2450ddda1a645d5511cfca854d35cc1254b20bb16271edaa5990a7c5fb28ea52df30b7eb290158988fe13128a09d7bd4401993be527a5cef655dbded8f1aebac82cb3e1a817bade56a5ad2e4db6d497e33b24389ff4d5066bde3754f792e9eb7159a2cf8138efe8adc9af9355a9e329223b644fb9e21e767059657516545b29aaad5c06de74e63b893aadd2411ff91bdb50d4c9cd9c3009a504fcf76a439c65a28477f97e4d4a44eabe6f0a268b1ee1cb8c78166679d60be099155b2b3e5f86cbbd3cbaa72980d2bb4fad80a774ede7c5a340902ce742ed00149880467d35fecc682a83759c05ad55fadabf620d6b7fbb872601d44d1d2b73daf08dc93b6a210b31ffd22a4c82d63cdacec6481d03763f5c3c8338af479bdc0da4905abce1009acd48534ebe15cc01082a4b961baf3aed4fefe3d3454a54454a7c668f28e1fb0d448628a4c0a9c95a1e7fa0f0edbe00e777164b0152e3fef5c4915bcd6b7303b7712cfea3398fd7bc6be9c73c906b980f95ce489e4307688b72fe7b7414fd7d19690f8cc46b48d296194caba210ec53ad7b00f1dd9e0839c97d912f1ce55676cc88104fd1be310c8d668786b4bc1a71e0ef44ccd10263717ecbdaff8f35fc79c792f2e49d80e4113ef5e8ee5c3fb2afd0a2579f6e976bfcfb5005a0cacb58e9b772f8ac6d83442f01f489920f394fde177d830e96dcbca42b98524977436ba9b4c980483d1221a2c07d957b53f494359deef14ed0966a624a5a27e1cd3d3b0932bc7d0a3d5b64cb6675bb36a7341dda096c3eb6ff7fd13c07effc4fcbd62f3765eeb6bd7e234d080e40dd0b8edcbd4bdb4dcf7f75a8213921718c2d2032d8eddc7ee652cd37308fde79564bd69bd79cc9426aef6fd35c953c2cb00c3d67cce913e558f2b22b6f3ed7574c4e3aa016119536507d5d8d4ac2b42fea96a76cf3a9fc30bc8132c52a6e158e238fafa90cace64f71e4a7b2590ea6586239c30e36679357ed9a047d2a052880bacc2c579f3f773ea58e58bb46e2bb8fef8931515483f179d6d620a65b9a05988394eee1decabe82b80718ae369e7fedc4a5db31a0f954589731a6d7217e0ddbf3e8487e8be1af17bff35d1b4315b0758214cb832402842c1f59681c45408eba363edf7c8cc7569ed157674b9bf124d295b8dbb81e211767479eeb817a68573f522033308fd2fb256cc895f22977cc25fd792a4c9fed4e873cf4f8957bcd5d4bee1d66ad9db079c7a9d75f464db2fcf5fcd2b8c0415cb2a9aa3038e7206a5f5c53bca67a50bcd0d62ec0601157f51dc58c18ed8167403c38598bee3d0e243d4866dfe1421cc67a4286721e5105c3199b4dfd48921cab80cd08ffcef7ff902e3a1772e25405c055b77f5667ce20eb18683cfef3cf8d8db2850ed8c3902081439a86e5d0d2dd1993fceac805fa983bbb78d0105be3202ade569aeb2b155e4d5ae438f84f50e0e787495a949b855c35e0fcab143b1a4776bdb64ff288194a6ef64d39df38e3e99522d5e0789eb0e535e787cb1a3afde26586400a3391ef15f6d13c00161f651d90ccd85ace81d84b2f18dfea52d797f6494a30ea2d1b5e45440c5da0d9ef6564191acc22ee36944489cdf020b2b07f3dcf12dacf227397596a47daa3a1d7cc8b1ff0252be2c3e8893b46961df8a3603e10d13fb772535612d6e44d68a2b46790f34791ea0378c707c9c963062153f6b7365571c4a5e4f23c272286c01deaa9fcba6821f759623d5894f79f2938b6e735074cf5e54480276e2049d72627e6d5c8eee1e6e7a1d240eb3c7298a3723e173c7b9bebc6771e5ba29bbdf987f4103de2828a709004651382e54b7d1832019c45fed023a8cf092bc4d80d5237a67de7bc30cd7261c4f0cfaebd1e00a570fb9755179469e8c2d4f2821b4a0af9722b7f1b0086d657267ca9cd3c0d23c4c5dc16c030fdc2fe6a890790c2eee2bd07a63caf9eacb7b5b8ef867ece7ef2b6e8ca00ff64e3e12529a5e6508d9aa020c692a5d4ed29ffd84e5428969e9d2d1edc483f98827ab86574cec307066faa7a4ce1bc671a6e17ce83a043c7a77c11a522ee15512e4d6a9b0db7f46f39c063a623eec82248560a6e8d431416758028d7edd2b33103756afd460c44ff4ea52f92245b254c0bda9185a441a57de6e069fa31c6d803b4ea2072024893afbbdb2b0e23b636790c4c2103f97431fd537f01cac7da30a1e0289c27d09a50d5494757219bb92f860b6b8f106887c66fca2e7f529df9fe025e04c1da99240325d55bfbd0990f7d2c72feece40240602c54bdedc273218eff09cbe1388c94ec229389e0501958633ce01723d58929fed96947d78dfa237614b46976a037982fc7a3d678596e2c95e83c344bf3deccd25c348323159ca93245c99678e1d3139bb98a73d99bdba3f567966b250c7172318f0d5912dacec9703506417bfd67b823fd14049a2a250f2f4f2d9521d3998536eab2f745f84da939d82831b1e3c438ae0afb8bdfff487008d27397c04288cf69e33a4c511b1dcf7d236f5d348f23fcbbc804f6328abe2cae8211f36c5ced451ad3b5aa510bcf9214146e99b8b3d33175d115574eb194acef79a7011adc2734518ee2af690aca88a27632a521f59585d974b5d3336b2bcd384db6f6681b4f4de7a8bdc55b3cfc31b5e1a065d5e104fc756271fa25f96bea3608faa3a0667c62cfc33fb186f2243d4ca0a7fb2d0a20b5011972e41942694eceafc894ca264dccdb5234f9150156f4e357b27d6e32d70d75e572f2024096d2f64fc06b1cd69e2d6f8b65b68ee85e56830d778766740a062dd2f8a75787c0b0917fc45c9257e109d94ba144a5d0f02da4a03407d6f6b9339aac1a109dddc75e7bc08ce82493ba8ffba09d297d03c0f7b6d1044674e24847f8f1a923d8a00eadb5a6eef2c183ed347cafcf03da47df76beef6b313ab7eb67f0f65e6f9e3c2c7f6ec1fc7476d5109f53e12310a6531445c864e852fd585f179a8fe2da6b24549b4ff288f67fcb1dcc84fa4f4ecedf19842c0279bef169f80ce95ba3fc7ab3bd0d92a63514788257c2c06198a71fea00d75e9f642b0926a1e2666f6ea5bd98913f232612fe024f0fefafdbb4fb270215d4a80c16c89aadb027783b1c4b1ec72adefe6ccbc8e4551351ac3cc1750cedf51cb68ed931c0045b6df2655a602ea03c43c4ee2cf36467002d343842b76a8cfa2be6732e166a5aa9b60e64333ec1be0b3362b78ade934f306d288a06dd07f1f5a4847ab157abf193fe7e1aaa66cfefcd18d2965237acae1c043c3c0dad578bd9e63b0e2fda9daea8d78d580c4ddf70e5de185cfe94171dd51a6882f6244402d193570100a3b9de30dd4b1c2d26f13421971a56dd37be4d1815fd4fe6cd1fa721002084afa613cf3d47b350b948097d207b146f99c776eb37bd0c25ac42311da644fa07258cf02455b533b79d45036c0e3cd7e92b77db776f4c84943249f9c8e4450319d1294d99c03cdb3c7629a5d0a3a841fd40a357d7a589f3dd6ef1f1925521ef02528200cb5b834cc8e712067f237d41b5612df66058593e7d16e04a9500762b7d0757190a93c4f0278b55f0193524995f2c20db0e79bd998b9a33fa06d125d9120b55e598a84a61125a994dbb83413fb05325a8fd88e148cbdb14cd036d105e07135497b77b13e299be93efeb7b75fa272eb2aa238ca3b34d9a42919e81c43c56dc25351f8646084d2d086de717ba717b1656ce67e87477000ea6f3d90a730e4f5a82d54729f9db0e14be14f9b1958c80c0cecfb488a4f4a12c61604b491cdab8cb36673cc7c523a3e3d081b489f19404b0a3ae4a349da806746cece96e601f171e25853a22e9cb5f0ef5ecb07e349f24e5526ad239633ed254331948d3146314ab9e92cd9e7216d20ade361584cea8b8a8138c0e27a01ef914afcfa121ff81d0e9e07305eab7ecf9926b8b1ac372d8a50036e02237c0ba4ee3dd34930970b3c1a8ceef2530b2db74e24986c42665c77133d5a4083ab31d750be96921870a087a567c96808e32b53cb02469d18a02e96ae6b86de340c40137d7a35d9ed4af86fd27fa88f72fc2bc68eab5102ba3cf171e1e207fed4fe0e9d10aade25e30581d46b263e89d370aff8e9fa0d93115ce67c85c317cd76e0c4707212d9688d92c38c7bc178c68eac5e9c63842845b0d0b9c216cff139917d2d7dcbbf822f4ff49fbb30b6067a33b4897361312115a585c8b70018912c6d65fd766d2c9ffe7792da707f755784741f6bba726a3caa7212537102f540ccb3395e6b63b272dc79db0b8ff7f17969bdebf59c6030c764d90cb2fdfcea0fe56e6ae6bf407cbe40980ea69438919a77b67625addb14a5fd21694e0bb1e6f29f94f034377911547f124032d1f26efa31c75f91f75c790aeccd12ddaeb836df6b58eb6e1a7771cab211febe9515b390577eaa4126aeaacb1fee16c6f6dcdb1bea471bb284f1a5c19369c3d3853652c038c75175cd3664fe7169409c6122e31406f2c4f3b4d08bc95efa0ad97e87d40cf4a610f3bcc5462cdca6ae23949ddc9c55657b7465be95c506b848c74e3f6a2195399189553db2dcd8dcf694894658542add841c3c09cf053cae1d2f40b6ad710e006d07dafc98f6b58ef15210582b9ba99d33315fdf6b336c52e5a2bafa89c63a52fb78d90ecf32647c6a21b931ef3a49bfc3a524b36ac50b7aa4226955c9bc806db61fe20bb267a1bc180a8df4f0dcb46e09ac2eac2d92a54310121f022f916fecdcff133647260aff5c0b2ebd682a749c4959e66d7214e979e2333e6fab4478750b9d5f72054a8f53149e38fa7ebab4051767b6d8687e44820eb791e64196e50e199280cf64531bfc3e4417b3c9f3227a78c883d9ee369740fd2e2691854c4960b506236292f6e2502c51197ff37ef8c941a0000000000000000000000000000000000000000000000000000000000000071b";

        address deployedPrec;
        assembly {
            deployedPrec := create(
                callvalue(),
                add(precomputationsInitCode, 0x20),
                mload(precomputationsInitCode)
            )
        }

        // Initialize proxy
        WebAuthnAccount proxy = WebAuthnAccount(
            payable(
                new ERC1967Proxy{salt: bytes32(uint256(1))}(
                    address(accountImpl),
                    abi.encodeCall(
                        WebAuthnAccount.initialize,
                        (
                            pubKey,
                            "20-RUhJT8AJ4hFdJZX2q63rtaL6xWUk93-NHeko7xIU",
                            deployedPrec
                        )
                    )
                )
            )
        );

        vm.mockCall(
            address(entryPoint),
            abi.encodeWithSelector(INonceManager.getNonce.selector),
            abi.encode(35529862795762677615465009376706450436748977128355174688306387864239197913088) 
        );

        // Authenticator data and client data JSON (in hex representation) retrieved from the webauthn signature
        bytes
            memory authenticatorDataBase64DecodedHex = hex"49960de5880e8c687434170f6476605b8fe4aeb9a28632c7995cf3ba831d97630500000000";
        bytes
            memory clientDataBase64DecodedHex = hex"7b2274797065223a22776562617574686e2e676574222c226368616c6c656e6765223a224d7a55314d6a6b344e6a49334f5455334e6a49324e7a63324d5455304e6a55774d446b7a4e7a59334d4459304e5441304d7a59334e4467354e7a63784d6a677a4e5455784e7a51324f44677a4d44597a4f4463344e6a51794d7a6b784f5463354d544d774f4467222c226f726967696e223a22687474703a2f2f6c6f63616c686f73743a33303030222c2263726f73734f726967696e223a66616c73657d";

        uint32 clientDataChallengeOffset = 36; // (72 / 2)


        bytes memory callData = abi.encode(
            authenticatorDataBase64DecodedHex,
            clientDataBase64DecodedHex,
            clientDataChallengeOffset
        );

        vm.startPrank(address(0));

        uint256 res = proxy.validateUserOp(
            UserOperation({
                sender: address(1),
                initCode: "",
                nonce: 1,
                callData: callData,
                callGasLimit: 1,
                verificationGasLimit: 1,
                preVerificationGas: 1,
                maxFeePerGas: 1,
                maxPriorityFeePerGas: 1,
                paymasterAndData: "",
                signature: signature
            }),
            "",
            0
        );
        assertEq(res, 0);
    }
}
